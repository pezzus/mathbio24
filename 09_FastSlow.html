<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-10-22">

<title>9&nbsp; Fast-Slow systems – Mathematical Biology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./08_MichaelinMenten.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01_Bathtub.html">Lectures</a></li><li class="breadcrumb-item"><a href="./09_FastSlow.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Fast-Slow systems</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Mathematical Biology</a> 
        <div class="sidebar-tools-main">
    <a href="./Mathematical-Biology.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Lectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Bathtub.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Bathtub model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Population.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Population dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Logistic model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Predation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Predation models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_LotkaVolterra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Lotka-Volterra model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Gause.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Gause type models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_RM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Rosenzweig-MacArthur model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_MichaelinMenten.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Michaelin-Menten law</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_FastSlow.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Fast-Slow systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignments/01_recap_ODEs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving ODEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignments/02_population.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Population dynamics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignments/03_spruce.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignments/04_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">System of ODEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignments/05_predators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prey-predator systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignments/06_reactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reactions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Labs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Laboratories/01_ODE_Integration/lab_ODEinteg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 01: Numerical integration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Laboratories/02_Predation/lab_Predation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 02: Predation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Laboratories/03_Bifurcations/lab_Bifurcations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 03: Bifurcations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Laboratories/04_Chaos/lab_chaos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 04: Chaos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Laboratories/05_Feedbacks/lab_feedback.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 05: Feedback loops</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IntroODE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Introduction to ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bifurcations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Introduction to bifurcations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Laboratories/00_Intro_Matlab/introMATLAB.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Introduction to MATLAB</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#michaelis-menten-law" id="toc-michaelis-menten-law" class="nav-link active" data-scroll-target="#michaelis-menten-law"><span class="header-section-number">9.1</span> Michaelis-Menten law</a>
  <ul class="collapse">
  <li><a href="#the-quasi-equilibrium-approximation" id="toc-the-quasi-equilibrium-approximation" class="nav-link" data-scroll-target="#the-quasi-equilibrium-approximation"><span class="header-section-number">9.1.1</span> The quasi-equilibrium approximation</a></li>
  <li><a href="#the-quasi-steady-state-approximation" id="toc-the-quasi-steady-state-approximation" class="nav-link" data-scroll-target="#the-quasi-steady-state-approximation"><span class="header-section-number">9.1.2</span> The quasi-steady-state approximation</a></li>
  </ul></li>
  <li><a href="#singular-perturbation-theory" id="toc-singular-perturbation-theory" class="nav-link" data-scroll-target="#singular-perturbation-theory"><span class="header-section-number">9.2</span> Singular perturbation theory</a>
  <ul class="collapse">
  <li><a href="#the-tichonov-theorem" id="toc-the-tichonov-theorem" class="nav-link" data-scroll-target="#the-tichonov-theorem"><span class="header-section-number">9.2.1</span> The Tichonov theorem</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01_Bathtub.html">Lectures</a></li><li class="breadcrumb-item"><a href="./09_FastSlow.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Fast-Slow systems</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Fast-Slow systems</span></h1>
<p class="subtitle lead">This lecture is based on <span class="citation" data-cites="ks08_vol1">(<a href="references.html#ref-ks08_vol1" role="doc-biblioref">Keener and Sneyd 2009, vol. 8/I, sec. 1.6.3</a>)</span></p>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 22, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 21, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="michaelis-menten-law" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="michaelis-menten-law"><span class="header-section-number">9.1</span> Michaelis-Menten law</h2>
<p>We consider again the reaction: <span class="math display">\[
\ce{S + E &lt;=&gt;[$k_1$][$k_{-1}$] C -&gt;[$k_2$] P + E}
\]</span></p>
<p>The system is: <span class="math display">\[
\left\{
\begin{aligned}{}
[\ce{S}]' &amp;= k_{-1}[\ce{C}] - k_1 [\ce{S}][\ce{E}], \\
[\ce{E}]' &amp;= (k_{-1}+k_1)[\ce{C}] - k_1 [\ce{S}][\ce{E}], \\
[\ce{C}]' &amp;= k_1 [\ce{S}][\ce{E}] - (k_{-1} + k_2)[\ce{C}], \\
[\ce{P}]' &amp;= k_2 [\ce{C}].
\end{aligned}
\right.
\]</span></p>
<p>We can remove one equation and substitute <span class="math inline">\([\ce{E}](t) = e_0 - [\ce{C}](t)\)</span>. We end up with a system of 2 equations: <span class="math display">\[
\left\{
\begin{aligned}{}
[\ce{S}]' &amp;= k_{-1}[\ce{C}] - k_1 [\ce{S}](e_0-[\ce{C}]), \\
[\ce{C}]' &amp;= k_1 [\ce{S}](e_0-[\ce{C}]) - (k_{-1} + k_2)[\ce{C}], \\
\end{aligned}
\right.
\]</span></p>
<p>with initial conditions <span class="math inline">\([\ce{S}](0) = s_0 &gt; 0\)</span> and <span class="math inline">\([\ce{C}](0) = 0\)</span>.</p>
<p>Here, we would like to show that the production rate follows the Michaelis-Menten law: <span class="math display">\[
[\ce{P}]' = V = \frac{V_\mathrm{max}[\ce{S}]}{K_m + [\ce{S}]},
\]</span></p>
<section id="the-quasi-equilibrium-approximation" class="level3" data-number="9.1.1">
<h3 data-number="9.1.1" class="anchored" data-anchor-id="the-quasi-equilibrium-approximation"><span class="header-section-number">9.1.1</span> The quasi-equilibrium approximation</h3>
<p>One way to derive the law is with the quasi-equilibrium assumption. This approach was proposed by Michaelis and Menten in 1913. They assumed that the first reaction <span class="math inline">\(\ce{S + E -&gt; C}\)</span> is approximately at equilibrium, thus: <span class="math display">\[
K_1 = \frac{k_{-1}}{k_1} = \frac{[\ce{S}][\ce{E}]}{[\ce{C}]}.
\]</span></p>
<p>Since <span class="math inline">\([\ce{C}] + [\ce{E}] = e_0\)</span>, we conclude that: <span class="math display">\[
K_1 = \frac{[\ce{S}](e_0-[\ce{C}])}{[\ce{C}]}, \quad\Rightarrow\quad
[\ce{C}] = \frac{e_0[\ce{S}]}{K_1 + [\ce{S}]}.
\]</span></p>
<p>But <span class="math inline">\([\ce{P}]' = V = k_2[\ce{C}]\)</span>, so: <span class="math display">\[
V = \frac{k_2 e_0[\ce{S}]}{K_1 + [\ce{S}]},
\]</span></p>
<p>which is Michaelis-Menten law with <span class="math inline">\(K_m = K_1\)</span> and <span class="math inline">\(V_\mathrm{max} = k_2 e_0\)</span>.</p>
<p>We remark that this derivation is an <em>approximation</em>. In fact, the only true equilibrium of the system is the origin, which is quite useless as an approximation. Here, we can <em>cannot</em> conclude that <span class="math inline">\([\ce{S}]' = 0\)</span>, in spite of the assumption. What we are actually saying is that, as we use <span class="math inline">\(\ce{S}\)</span> in the reaction, the concentration of the complex approximately follows the concentration of <span class="math inline">\(\ce{S}\)</span> according to the Michaelis-Menten law.</p>
<p>We can derive a law for <span class="math inline">\([\ce{S}]\)</span> by noting that (from the system) <span class="math display">\[
[\ce{S}]' + [\ce{C}]' = -k_2 [\ce{C}],
\]</span></p>
<p>so <span class="math display">\[
\frac{\mathrm{d}}{\mathrm{d}t}\bigl( [\ce{S}] + [\ce{C}] \bigr) = \frac{\mathrm{d}}{\mathrm{d}t}\Bigl( [\ce{S}] + \frac{e_0[\ce{S}]}{K_1 + [\ce{S}]} \Bigr) = -k_2 \frac{e_0[\ce{S}]}{K_1 + [\ce{S}]},
\]</span></p>
<p>and after rearranging we have <span class="math display">\[
\frac{\mathrm{d}[\ce{S}]}{\mathrm{d}t}\Bigl( 1 + \frac{K_1 e_0}{(K_1 + [\ce{S}])^2} \Bigr) = -\frac{k_2 e_0[\ce{S}]}{K_1 + [\ce{S}]},
\]</span></p>
<p>which gives a differential equation for <span class="math inline">\([\ce{S}](t)\)</span>.</p>
<p>The quasi-equilibrium approximation is very easy, powerful, and extensively applied in enzymatic reaction. It is possible to prove this approximation in a more mathematical way by assuming <span class="math inline">\(k_{-1} \gg k_2\)</span>, but we will follow a different approach below.</p>
</section>
<section id="the-quasi-steady-state-approximation" class="level3" data-number="9.1.2">
<h3 data-number="9.1.2" class="anchored" data-anchor-id="the-quasi-steady-state-approximation"><span class="header-section-number">9.1.2</span> The quasi-steady-state approximation</h3>
<p>First, let us rescale the equations by the transformations: <span class="math display">\[
x = \frac{[\ce{S}]}{s_0}, \quad
y = \frac{[\ce{C}]}{e_0}, \quad
\tau = k_1 e_0 t.
\]</span></p>
<p>After changing the variables, we get: <span class="math display">\[
\left\{
\begin{aligned}
\frac{\mathrm{d}x}{\mathrm{d}\tau} &amp;= \frac{k_{-1}}{s_0 k_1} y - x (1-y), \\
\frac{\mathrm{d}y}{\mathrm{d}\tau} &amp;= \frac{s_0}{e_0} x (1-y) - \frac{k_{-1} + k_2}{k_1 e_0} y, \\
\end{aligned}
\right.
\]</span></p>
<p>that we can rearrange in the following form: <span class="math display">\[
\left\{
\begin{aligned}
\frac{\mathrm{d}x}{\mathrm{d}\tau} &amp;= -x + y(x+\alpha), \\
\varepsilon \frac{\mathrm{d}y}{\mathrm{d}\tau} &amp;= x -y(x + \beta),
\end{aligned}
\right.
\]</span></p>
<p>where: <span class="math display">\[
\alpha = \frac{k_{-1}}{s_0 k_1}, \quad
\beta = \frac{k_{-1} + k_2}{k_1 s_0}, \quad
\varepsilon = \frac{e_0}{s_0}.
\]</span></p>
<p>Next, suppose that <span class="math inline">\(\varepsilon \ll 1\)</span>, that is the initial concentration of the enzyme is, at the start, very low compared to the concentration of the substrate. Thus, we could assume that <span class="math inline">\(\varepsilon y' \approx 0\)</span>: <span class="math display">\[
\left\{
\begin{aligned}
\frac{\mathrm{d}x}{\mathrm{d}\tau} &amp;= -x + y(x+\alpha), \\
0 &amp;= x -y(x + \beta).
\end{aligned}
\right.
\]</span></p>
<p>This approach is called <em>quasi-steady-state approximation</em>. From the second equation we conclude that <span class="math display">\[
y = \frac{x}{\beta + x}, \quad\Rightarrow\quad [\ce{C}] = \frac{[e_0 \ce{S}]}{\frac{k_{-1} + k_2}{k_1} + [\ce{S}]}.
\]</span></p>
<p>We conclude that with the QSS approximation the Michaelis-Menten law has the same form with <span class="math inline">\(V_\mathrm{max} = k_2 e_0\)</span> (as before) and <span class="math inline">\(K_m = \frac{k_{-1}+k_2}{k_1}\)</span> (different, before was <span class="math inline">\(K_m = K_1\)</span>). The difference is minimal: in the quasi-equilibrium approximation, we have <span class="math inline">\(k_2 \ll k_{-1}\)</span>, so <span class="math inline">\(K_m \approx K_1\)</span>, whereas for the QSS approximation we assume <span class="math inline">\(\varepsilon \ll 1\)</span>.</p>
<p>The Michaelis-Menten law is quite general and often evoked without deriving it (similarly to Holling type predations.) For us, it is the main ingredient for more complex reactions.</p>
</section>
</section>
<section id="singular-perturbation-theory" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="singular-perturbation-theory"><span class="header-section-number">9.2</span> Singular perturbation theory</h2>
<p>Let dive a bit deeper on the QSS approximation. The idea is the following: since <span class="math inline">\(\varepsilon\)</span> is small, we could try to approximate the solution of the IVP <span class="math display">\[
\left\{
\begin{aligned}
\frac{\mathrm{d}x_\varepsilon}{\mathrm{d}\tau} &amp;= -x_\varepsilon + y_\varepsilon(x_\varepsilon+\alpha), \\
\varepsilon \frac{\mathrm{d}y_\varepsilon}{\mathrm{d}\tau} &amp;= x_\varepsilon -y_\varepsilon(x_\varepsilon + \beta), \\
x_\varepsilon(0) &amp;= 1, \\
y_\varepsilon(0) &amp;= 0,
\end{aligned}
\right.
\]</span></p>
<p>with <em>another</em> IVP obtained from the limit <span class="math inline">\(\varepsilon\to 0\)</span>. Ideally, the solution of such IVP, say <span class="math inline">\((x(t),y(t))\)</span>, should be the limit of <span class="math inline">\((x_\varepsilon(t),y_\varepsilon(t))\)</span> for <span class="math inline">\(\varepsilon\to 0\)</span>. This approach is called <em>perturbation argument</em>.</p>
<p>Very often it is enough to take the limit in the ODE, as we did before. So we could approximate the problem with <span class="math display">\[
\left\{
\begin{aligned}
\frac{\mathrm{d}x}{\mathrm{d}\tau} &amp;= -x + y(x+\alpha), \\
0 &amp;= x -y(x + \beta), \\
x(0) &amp;= 1, \\
y(0) &amp;= 0.
\end{aligned}
\right.
\]</span></p>
<p>However, in this case it does not work, because the problem is not well-posed. In fact, we have 2 initial conditions, but only one ODE! The second ODE became an algebraic equation (this system is called Differential Algebraic Equation). We can only satisfy one initial condition. From the second equation we have: <span class="math display">\[
y = \frac{x}{x + \beta},
\]</span></p>
<p>for <span class="math inline">\(x(0)=1\)</span>, <span class="math inline">\(y(0)=\frac{1}{1+\beta}\)</span>, whereas for <span class="math inline">\(y(0)=0\)</span> we have <span class="math inline">\(x(0)=0\)</span>. The combination <span class="math inline">\(x(0)=1\)</span> and <span class="math inline">\(y(0)=0\)</span> does not work. (We say that the initial condition is not <em>compatible</em>.) The perturbation argument is <em>singular</em>.</p>
<p>We need a better strategy. Let us rescale the time as follows: <span class="math display">\[
\eta = \frac{\tau}{\varepsilon}, \quad
x(\tau) = x(\varepsilon \eta) = \tilde{x}(\eta), \quad
y(\tau) = y(\varepsilon \eta) = \tilde{y}(\eta).
\]</span></p>
<p>The scale <span class="math inline">\(\eta\)</span> is <em>fast</em>, because one unit of <span class="math inline">\(\eta\)</span> time corresponds to <span class="math inline">\(\varepsilon\)</span> units of <span class="math inline">\(\tau\)</span> time. The new system reads: <span class="math display">\[
\left\{
\begin{aligned}
\frac{\mathrm{d}\tilde{x}_\varepsilon}{\mathrm{d}\eta} &amp;= \varepsilon \Bigl( -\tilde{x}_\varepsilon + \tilde{y}_\varepsilon(\tilde{x}_\varepsilon+\alpha) \Bigr), \\
\frac{\mathrm{d}\tilde{y}_\varepsilon}{\mathrm{d}\eta} &amp;= \tilde{x}_\varepsilon -\tilde{y}_\varepsilon(\tilde{x}_\varepsilon + \beta), \\
\tilde{x}_\varepsilon(0) &amp;= 1, \\
\tilde{y}_\varepsilon(0) &amp;= 0.
\end{aligned}
\right.
\]</span></p>
<p>As before, we formally take <span class="math inline">\(\varepsilon = 0\)</span>, and obtain: <span class="math display">\[
\left\{
\begin{aligned}
\frac{\mathrm{d}\tilde{x}}{\mathrm{d}\eta} &amp;= 0, \\
\frac{\mathrm{d}\tilde{y}}{\mathrm{d}\eta} &amp;= \tilde{x} -\tilde{y}(\tilde{x} + \beta), \\
\tilde{x}(0) &amp;= 1, \\
\tilde{y}(0) &amp;= 0.
\end{aligned}
\right.
\]</span></p>
<p>The perturbation in this case is not singular, we can solve it and find: <span class="math display">\[
\begin{aligned}
\tilde{x}(\eta) &amp;= 1, \\
\tilde{y}(\eta) &amp;= \frac{1 - e^{-(1+\beta)\eta}}{1+\beta}.
\end{aligned}
\]</span></p>
<p>The second equation follows from the integration of the second ODE, which is linear. The solution of the <em>fast problem</em> (in the variable <span class="math inline">\(\eta\)</span>) represents the dynamic from the initial condition up to… something we will see. For <span class="math inline">\(\eta\to\infty\)</span>, thus for long time in the metric of the fast system (but not so long time for the slow system), we have: <span class="math display">\[
\begin{aligned}
\tilde{x}(\eta) &amp;\to 1, \\
\tilde{y}(\eta) &amp;\to \frac{1}{1+\beta}.
\end{aligned}
\]</span></p>
<p>Interestingly, for long <span class="math inline">\(\eta\)</span> the fast solution matches the <em>slow solution</em> <span class="math inline">\((x(\tau),y(\tau))\)</span> for <span class="math inline">\(\tau=0\)</span>! In other words, the equilibrium of the fast system provides a <em>compatible</em> initial condition for the slow system.</p>
<p>We are now in condition to approximate the solution as <span class="math inline">\(\varepsilon\to0\)</span>:</p>
<ol type="1">
<li><p>For <span class="math inline">\(\tau\in[0,\varepsilon)\)</span>, we have the fast solution <span class="math display">\[
\begin{aligned}
x(\tau) &amp;= 1, \\
y(\tau) &amp;= \frac{1 - e^{-\frac{1+\beta}{\varepsilon}\tau}}{1+\beta}.
\end{aligned}
\]</span></p></li>
<li><p>For <span class="math inline">\(\tau &gt; \varepsilon\)</span>, we have the slow solution: <span class="math display">\[
\begin{aligned}
\frac{\mathrm{d}x}{\mathrm{d}\tau} &amp;= -x + \frac{x(x+\alpha)}{x+\beta}, \\
y(\tau) &amp;= \frac{x(\tau)}{x(\tau)+\beta}.
\end{aligned}
\]</span></p></li>
</ol>
<p>Note that in the limit we “forget” the fast dynamic.</p>
<section id="the-tichonov-theorem" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="the-tichonov-theorem"><span class="header-section-number">9.2.1</span> The Tichonov theorem</h3>
<p>In general, we can consider the following problem: <span class="math display">\[
\left\{\begin{aligned}
\varepsilon \frac{\mathrm{d}z_\varepsilon}{\mathrm{d}t} &amp;= F(z_\varepsilon,y_\varepsilon,\varepsilon), \\
\frac{\mathrm{d}y_\varepsilon}{\mathrm{d}t} &amp;= f(z_\varepsilon,y_\varepsilon,\varepsilon), \\
z_\varepsilon(t_0) &amp;= y_0, \\
y_\varepsilon(t_0) &amp;= z_0.
\end{aligned}\right.
\]</span></p>
<p>Suppose that we satisfy all the hypotheses for well-posedness.</p>
<p>When <span class="math inline">\(\varepsilon \ll 1\)</span>, we identify <span class="math inline">\(z(t)\)</span> as the <em>fast</em> variable, and <span class="math inline">\(y(t)\)</span> as the <em>slow</em> variable.</p>
<p>Let <span class="math inline">\(z = \phi(y)\)</span> be a root of the equation <span class="math inline">\(F(z,y,0)=0\)</span> defined in some closed and bounded domain <span class="math inline">\(D\subset\mathbb{R}^m\)</span>, that is, <span class="math inline">\(F(\phi(y),y,0)=0\)</span> for <span class="math inline">\(y\in D\)</span>. Consider the degenerate (slow) system: <span class="math display">\[
\left\{\begin{aligned}
\frac{\mathrm{d}y}{\mathrm{d}t} &amp;= f\bigl(\phi(y),y,0\bigr), \\
y(t_0) &amp;= y_0,
\end{aligned}\right.
\]</span></p>
<p>where we denote by <span class="math inline">\(y(t)\)</span> its solution. We would like to show that the solution <span class="math inline">\((\phi(y(t)),y(t))\)</span> is the limit of the original solution <span class="math inline">\((z_\varepsilon(t),y_\varepsilon(t))\)</span> as <span class="math inline">\(\varepsilon \to 0\)</span>.</p>
<p>We have the following result.</p>
<div id="thm-tichonov" class="theorem">
<p><span class="theorem-title"><strong>Theorem 9.1</strong></span> Suppose that</p>
<ol type="1">
<li><p><span class="math inline">\(z=\phi(y)\)</span> is an isolated root in <span class="math inline">\(D\)</span>, positively stable uniformly in <span class="math inline">\(y\in D\)</span> with respect to the adjointed system <span class="math display">\[
\frac{\mathrm{d}z}{\mathrm{d}\tau} = F(z,y,0), \quad \tau = \frac{t}{\varepsilon}.
\]</span></p></li>
<li><p>the initial point <span class="math inline">\((z_0,y_0)\)</span> is in the basin of attraction of the equilibrium <span class="math inline">\(\phi(y)\)</span>,</p></li>
<li><p>the solution <span class="math inline">\(y(t)\)</span> of the degerate system belongs to <span class="math inline">\(D\)</span> for all <span class="math inline">\(t\in[t_0,T]\)</span>.</p></li>
</ol>
<p>Then the solution <span class="math inline">\((z_\varepsilon(t),y_\varepsilon(t))\)</span> of the overall system tends to the degenerate solution <span class="math inline">\((\phi(y(t)),y(t))\)</span> as <span class="math inline">\(\varepsilon \to 0\)</span>, in the sense that, for any <span class="math inline">\(T_0 \in (t_0, T)\)</span>, <span class="math display">\[
\lim_{\varepsilon\to 0} (z_\varepsilon(t), y_\varepsilon(t)) = (\phi(y(t)),y(t)),
\]</span></p>
<p>for <span class="math inline">\(t_0 &lt; t &lt; T_0 \le T\)</span>.</p>
</div>
<p>The proof of the theorem is technical, but intuitive. At the beginning, we have the fast dynamics, that will bring the initial point <span class="math inline">\((z_0,y_0)\)</span> at equilibrium for the fast system. This happens for <span class="math inline">\(y\)</span> fixed and <span class="math inline">\(z(\tau)\)</span> converging towards the equilibrium <span class="math inline">\(z=\phi(y)\)</span>. This dynamic occurs in <span class="math inline">\(\mathcal{O}(\varepsilon)\)</span> units of time. So, as <span class="math inline">\(\varepsilon\to 0\)</span> we can ignore it and suppose that we are already at equilibrium and starting from <span class="math inline">\((\phi(y_0),y_0)\)</span>. Once at equilibrium, we have the slow dynamics in <span class="math inline">\(y(t)\)</span>. Note that we cannot deviate from the manifold <span class="math inline">\(z = \phi(y)\)</span>, because it is asymptotically stable and we converge quickly towards it.</p>
<p>What if we move <em>off</em> the manifold? For instance, consider the spruce-budworm system, <span class="math display">\[
\left\{\begin{aligned}
\varepsilon u' &amp;= \rho u (1-u/q) - \frac{u^2}{1+u^2},\\
\rho' &amp;= f(u,\rho,q), \\
q'    &amp;= g(u,\rho,q),
\end{aligned}\right.
\]</span></p>
<p>where <span class="math inline">\(u(t)\)</span> is <em>fast</em>, and <span class="math inline">\(\rho(t)\)</span> and <span class="math inline">\(q(t)\)</span> are slow. We know that <span class="math display">\[
\psi(u,\rho,q) = \rho (1-u/q) - \frac{u}{1+u^2} = 0,
\]</span></p>
<p>defines a surface in <span class="math inline">\(\mathbb{R}^3\)</span> of equilibria for the fast dynamics. However, we cannot represent this as a function: <span class="math display">\[
u = \phi(\rho,q),
\]</span></p>
<p>or at least not always. The function <span class="math inline">\(\phi\)</span> would be multi-valued (for some choice of the parameters we can have up to 3 equilibria).</p>
<p><img src="img/Budworm_3D.png" class="img-fluid"></p>
<p>We can define multiple surfaces: <span class="math display">\[
\begin{aligned}
u &amp;= \phi_1(\rho,q), \quad (\rho,q) \in D_1, \\
u &amp;= \phi_2(\rho,q), \quad (\rho,q) \in D_2, \\
u &amp;= \phi_3(\rho,q), \quad (\rho,q) \in D_3,
\end{aligned}
\]</span></p>
<p>one for each equilibrium. The domains overlap: in the bistable region, all functions are well-defined. Note also that <span class="math inline">\(\phi_2\)</span> is always unstable, so we will never go there.</p>
<p>Now we can apply the Theorem, very some care concerning the initial conditions. Depending on where we start, we may go to a different branch.</p>
<p>Once on the surface, we have the slow dynamics: <span class="math display">\[
\left\{\begin{aligned}
\rho' &amp;= f(\phi_i(\rho,q),\rho,q), \\
q'    &amp;= g(\phi_i(\rho,q),\rho,q),
\end{aligned}\right.
\]</span></p>
<p>with <span class="math inline">\(i=1,3\)</span> depending on the stable branch. Actually, if the initial condition <span class="math inline">\((\rho_0,q_0)\in D_2\)</span>, the bistable region, then <span class="math inline">\(i=1\)</span> if <span class="math inline">\(u_0 &lt; \phi_2(\rho_0,q_0)\)</span> otherwise <span class="math inline">\(i=3\)</span>. If <span class="math inline">\((\rho_0,q_0)\in D_i \setminus D_2\)</span>, that is away from the bistable region, then the branch is <span class="math inline">\(\phi_i\)</span>.</p>
<p>Until <span class="math inline">\((\rho(t),q(t))\in D_i\)</span>, the dynamic proceeds with no issues. However, if <span class="math inline">\((\rho(t),q(t))\)</span> reaches the boundary of <span class="math inline">\(D_i\)</span>, then the slow dynamic is over. Say that this happens at some time <span class="math inline">\(T_0 &gt; t_0\)</span>.</p>
<p>We can continue, and apply again the Tichonov theorem with initial condition slightly off the “rim” of the surface, and look for another stable branch of equilibria. Then we go there and we will have a new slow dynamic.</p>
<p>Below 2 examples: in the first case we move counterclockwise in the <span class="math inline">\((\rho,q)\)</span> plane. In the other, we move clockwise.</p>
<p><img src="img/BudwormCircle.png" class="img-fluid"></p>
<p><img src="img/BudwormCircleBack.png" class="img-fluid"></p>
<p>Note also the temporal dynamic, where <span class="math inline">\(u\)</span> proceeds smoothly until a sudden drop (around <span class="math inline">\(t=12\)</span> and <span class="math inline">\(t=34\)</span>). This is when we have the fast dynamic.</p>
<p><img src="img/BudwormTime.png" class="img-fluid"></p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-ks08_vol1" class="csl-entry" role="listitem">
Keener, James, and James Sneyd. 2009. <em>Mathematical Physiology: I: Cellular Physiology</em>. Second. Vol. 8/I. Springer. <a href="https://strutture-provincia.primo.exlibrisgroup.com/permalink/39SBT_INST/ghkipk/alma991012367489706186">https://strutture-provincia.primo.exlibrisgroup.com/permalink/39SBT_INST/ghkipk/alma991012367489706186</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./08_MichaelinMenten.html" class="pagination-link" aria-label="Michaelin-Menten law">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Michaelin-Menten law</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>