<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-10-07">

<title>5&nbsp; Lotka-Volterra model – Mathematical Biology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06_Gause.html" rel="next">
<link href="./04_Predation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01_Bathtub.html">Lectures</a></li><li class="breadcrumb-item"><a href="./05_LotkaVolterra.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Lotka-Volterra model</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Mathematical Biology</a> 
        <div class="sidebar-tools-main">
    <a href="./Mathematical-Biology.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Lectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Bathtub.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Bathtub model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Population.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Population dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Logistic model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Predation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Predation models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_LotkaVolterra.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Lotka-Volterra model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Gause.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Gause type models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_RM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Rosenzweig-MacArthur model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignments/01_recap_ODEs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving ODEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignments/02_population.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Population dynamics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignments/03_spruce.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignments/04_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">System of ODEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignments/05_predators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prey-predator systems</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Labs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Laboratories/01_ODE_Integration/lab_ODEinteg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 01: Numerical integration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Laboratories/02_Predation/lab_Predation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 02: Predation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Laboratories/03_Bifurcations/lab_Bifurcations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 03: Bifurcations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Laboratories/04_Chaos/lab_chaos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 04: Chaos</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IntroODE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Introduction to ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bifurcations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Introduction to bifurcations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Laboratories/00_Intro_Matlab/introMATLAB.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Introduction to MATLAB</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#prey-predator-models" id="toc-prey-predator-models" class="nav-link active" data-scroll-target="#prey-predator-models"><span class="header-section-number">5.1</span> Prey-predator models</a></li>
  <li><a href="#lotka-volterra-model" id="toc-lotka-volterra-model" class="nav-link" data-scroll-target="#lotka-volterra-model"><span class="header-section-number">5.2</span> Lotka-Volterra model</a>
  <ul class="collapse">
  <li><a href="#equilibria" id="toc-equilibria" class="nav-link" data-scroll-target="#equilibria"><span class="header-section-number">5.2.1</span> Equilibria</a></li>
  <li><a href="#phase-portrait" id="toc-phase-portrait" class="nav-link" data-scroll-target="#phase-portrait"><span class="header-section-number">5.2.2</span> Phase portrait</a></li>
  <li><a href="#the-fishery-problem" id="toc-the-fishery-problem" class="nav-link" data-scroll-target="#the-fishery-problem"><span class="header-section-number">5.2.3</span> The fishery problem</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01_Bathtub.html">Lectures</a></li><li class="breadcrumb-item"><a href="./05_LotkaVolterra.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Lotka-Volterra model</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Lotka-Volterra model</span></h1>
<p class="subtitle lead">This lecture is based on <span class="citation" data-cites="ip14">(<a href="references.html#ref-ip14" role="doc-biblioref">Iannelli and Pugliese 2014, vol. 79, sec. 6.1</a>)</span></p>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 7, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 15, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="prey-predator-models" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="prey-predator-models"><span class="header-section-number">5.1</span> Prey-predator models</h2>
<p>In all previous models, predation was only at cost of preys. Generalist predators, like humans, can survive even in absence of preys. Thus, <span class="math inline">\(P^*\)</span> can be assumed constant.</p>
<p>What if the predator is a <em>specialist</em>, that is it can only hunt a specific prey? When the prey population gets too low, also survival of the predator could be at risk. One equation is not enough.</p>
<p>A classic example is the Hare-Lynx dynamics, shown below:</p>
<p><img src="img/Figure_45_06_01.jpg" class="img-fluid"></p>
<p>The data actually shows pelt-trading data taken from the Hudson’s Bay Company <span class="citation" data-cites="elton1942ten">Elton and Nicholson (<a href="references.html#ref-elton1942ten" role="doc-biblioref">1942</a>)</span>. We observe that data is oscillatory with a 10-year period. How is that?</p>
</section>
<section id="lotka-volterra-model" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="lotka-volterra-model"><span class="header-section-number">5.2</span> Lotka-Volterra model</h2>
<p><em>(Story time)</em> During the 1920s, the biologist Umberto D’Ancona (who married Volterra’s daughter) noticed that during World War I, in his fishery data in the Adriatic Sea, the frequency of predation increased significantly. He could not explain this phenomenon, but it should have been somehow related to a decrease of fishery during the war. Furthermore, the data was oscillatory.</p>
<p>In 1926, Vito Volterra proposed a model for the prey-predator interaction. (After the publication on <em>Nature</em>, Alfred Lotka wrote a short communication, still on <em>Nature</em>, where he points out that his book “Elements of Physical Biology”, published in 1924, covered the same model. See also the book <span class="citation" data-cites="volterra1932">Volterra (<a href="references.html#ref-volterra1932" role="doc-biblioref">1932</a>)</span>.) Suppose that</p>
<ul>
<li><span class="math inline">\(H(t)\)</span> is the population of <em>preys</em> over time, and</li>
<li><span class="math inline">\(P(t)\)</span> is the population of <em>predators</em> over time.</li>
</ul>
<p>Volterra made the following hypotheses:</p>
<ol type="1">
<li>The growth rate for prey and predator is Malthusian;</li>
<li>In absence of predators, <span class="math inline">\(H(t)\)</span> increases;</li>
<li>In absence of preys, <span class="math inline">\(P(t)\)</span> decreases;</li>
<li>In a unit of time, the number of preys consumed by predators is <span class="math inline">\(-a H(t)P(t)\)</span>;</li>
<li>In a unit of time, successful predation increases the number of predators by <span class="math inline">\(\gamma a H(t)P(t)\)</span>.</li>
</ol>
<p>The <em>Lotka-Volterra model</em> readily follows: <span class="math display">\[
\left\{\begin{aligned}
H' &amp;= r H - a H P, \\
P' &amp;= -\mu P + \gamma a H P.
\end{aligned}\right.
\]</span></p>
<p>We can also rewrite the system as: <span class="math display">\[
\left\{\begin{aligned}
H' &amp;= H F(P), \\
P' &amp;= P G(H),
\end{aligned}\right.
\]</span></p>
<p>for <span class="math inline">\(F(P) = r - aP\)</span> and <span class="math inline">\(G(H) = -\mu + \gamma a H\)</span>. The system is in Kolmogorov form: orbits cannot cross the axes <span class="math inline">\(H=0\)</span> and <span class="math inline">\(P=0\)</span>, so trajectories starting in the positive quadrant remain in the positive quadrant.</p>
<section id="equilibria" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="equilibria"><span class="header-section-number">5.2.1</span> Equilibria</h3>
<p>We have the trivial equilibrium <span class="math inline">\((H,P)=(0,0)=E_0\)</span>, and another one satisfying: <span class="math display">\[
\left\{\begin{aligned}
r - a P &amp;= 0, \\
-\mu + \gamma a H &amp;= 0.
\end{aligned}\right.
\]</span></p>
<p>So, <span class="math inline">\(E^* = (H^*,P^*) = (\frac{\mu}{\gamma a}, \frac{r}{a})\)</span>. It is positive, thus biologically feasible.</p>
<p>The stability follows from the Jacobian (see <a href="IntroODE.html#sec-stabilityLinear" class="quarto-xref"><span>Section A.5.4.2</span></a>): <span class="math display">\[
J(H,P) = \begin{pmatrix} r - aP &amp; -aH \\ \gamma a P &amp; -\mu + \gamma a H \end{pmatrix}.
\]</span></p>
<p>For <span class="math inline">\(E_0\)</span>, we have <span class="math inline">\(J(0,0)\)</span> diagonal with eigenvalues <span class="math inline">\(r\)</span> and <span class="math inline">\(-\mu\)</span>. It is a saddle.</p>
<p>For <span class="math inline">\(E^*\)</span>, we have <span class="math display">\[
J(H^*,P^*) = \begin{pmatrix} 0 &amp; - a H^* \\ \gamma a P^* &amp; 0 \end{pmatrix}
\]</span></p>
<p>which has eigenvalues with zero real part, because the determinant is positive but the trace is zero. Thus, we have a center. The solutions of the linear equation are periodic with a period <span class="math display">\[
T_\mathrm{linear} = \frac{2\pi}{\sqrt{\det J(H^*,P^*)}} = \frac{2\pi}{\sqrt{\mu r}}.
\]</span></p>
<p>Unfortunately, the linearization does not help to conclude anything for the non-linear case.</p>
</section>
<section id="phase-portrait" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="phase-portrait"><span class="header-section-number">5.2.2</span> Phase portrait</h3>
<p>On the other hand, the system is in Hamiltonian form (see <a href="IntroODE.html#sec-hamiltonian" class="quarto-xref"><span>Section A.6.1</span></a>). To find the Hamiltonian, here denoted by <span class="math inline">\(\mathcal{H}(H,P)\)</span> to avoid confusion with <span class="math inline">\(H(t)\)</span>, we notice that: <span class="math display">\[
\frac{\mathrm{d}H}{\mathrm{d}P} = \frac{\mathrm{d}H/\mathrm{d}t}{\mathrm{d}P/\mathrm{d}t} = \frac{H F(P)}{P G(H)},
\]</span></p>
<p>and the ODE is in separable form, so we have: <span class="math display">\[
\int_{H_0}^{H(t)} \frac{G(h)}{h}\mathrm{d}h = \int_{P_0}^{P(t)} \frac{F(p)}{p}\mathrm{d}p.
\]</span></p>
<p>We can easily carry out the integration: <span class="math display">\[
\Bigl. -\mu\ln h + \gamma a h \Bigr|_{H_0}^{H(t)} = \Bigl. r \ln p - a p \Bigr|_{P_0}^{P(t)},
\]</span></p>
<p>and we find that: <span class="math display">\[
-\mu \ln H(t) + \gamma a H(t) - r \ln P(t) + a P(t) = -\mu \ln H_0 + \gamma a H_0 - r \ln P_0 + a P_0.
\]</span></p>
<p>Since the right hand side is a constant, we have found that along the trajectory parallel to flow <span class="math inline">\(\mathrm{d}H/\mathrm{d}P\)</span> the quantity <span class="math display">\[
\mathcal{H}\bigl(H(t),P(t)\bigr) = -\mu \ln H(t) + \gamma a H(t) - r \ln P(t) + a P(t)
\]</span></p>
<p>remains constant. Thus, <span class="math inline">\(\mathcal{H}\)</span> is an Hamiltonian. We can check this again by noting that <span class="math display">\[
\begin{split}
\frac{\mathrm{d}}{\mathrm{d}t} \mathcal{H}\bigl(H(t),P(t)\bigr) &amp;= \frac{\partial \mathcal{H}}{\partial H} H' + \frac{\partial \mathcal{H}}{\partial P} P' \\
&amp;= \Bigl( -\frac{\mu}{H} + \gamma a \Bigr) H F(P) + \Bigl( -\frac{r}{P} + a \Bigr) P G(H) \\
&amp;= G(H) F(P) - F(P) G(H) = 0.
\end{split}
\]</span></p>
<p>We conclude that level sets of <span class="math inline">\(\mathcal{H}\)</span> are orbits of the system. Are they closed? Yes, because the function <span class="math inline">\(\mathcal{H}(H,P)\to+\infty\)</span> as <span class="math inline">\((H,P)\to+\infty\)</span> or <span class="math inline">\((H,P)\to 0^+\)</span>. Moreover, <span class="math inline">\(\mathcal{H}\)</span> is bounded from below, with minimum for <span class="math inline">\((H,P)=(H^*,P^*)\)</span>. In fact, since <span class="math inline">\(E^*\)</span> is an equilibrium, <span class="math inline">\(\nabla\mathcal{H}|_{E^*} = 0\)</span>. Furthermore, the Hessian <span class="math inline">\(\nabla^2 \mathcal{H}|_{E^*}\)</span> is positive definite.</p>
<div id="ee4d7ae4" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>sns.set_theme(<span class="st">"notebook"</span>, style<span class="op">=</span><span class="st">"whitegrid"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>r,mu,a,gamma <span class="op">=</span> <span class="fl">0.5</span>,<span class="fl">1.0</span>,<span class="fl">1.0</span>,<span class="fl">0.75</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>Ham <span class="op">=</span> <span class="kw">lambda</span> H,P: <span class="op">-</span>mu<span class="op">*</span>np.log(H) <span class="op">+</span> gamma<span class="op">*</span>a<span class="op">*</span>H <span class="op">-</span> r<span class="op">*</span>np.log(P) <span class="op">+</span> a<span class="op">*</span>P</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>Hs,Ps <span class="op">=</span> mu<span class="op">/</span>(gamma<span class="op">*</span>a), r<span class="op">/</span>a</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>[HH,PP] <span class="op">=</span> np.mgrid[<span class="fl">0.01</span>:<span class="fl">4.5</span>:<span class="ot">100j</span>,<span class="fl">0.01</span>:<span class="fl">2.5</span>:<span class="ot">100j</span>]</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>lvls <span class="op">=</span> [<span class="fl">1.6</span>,<span class="fl">1.7</span>,<span class="fl">1.8</span>,<span class="fl">2.0</span>,<span class="fl">2.5</span>]</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>sns.despine()</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>ax.xaxis.set_ticks([Hs])</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>ax.yaxis.set_ticks([Ps])</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>ax.xaxis.set_ticklabels([<span class="st">'$H^*$'</span>])</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>ax.yaxis.set_ticklabels([<span class="st">'$P^*$'</span>])</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>ax.contour(HH,PP,Ham(HH,PP),</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    levels<span class="op">=</span>lvls,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    colors<span class="op">=</span>[<span class="st">'k'</span>]<span class="op">*</span><span class="bu">len</span>(lvls),</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    linewidths<span class="op">=</span>[<span class="fl">1.0</span>,<span class="fl">1.0</span>,<span class="fl">1.0</span>,<span class="fl">2.0</span>,<span class="fl">1.0</span>])</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>ax.plot([Hs],[Ps],<span class="st">'k.'</span>,markersize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05_LotkaVolterra_files/figure-html/cell-2-output-1.png" width="570" height="418" class="figure-img"></p>
<figcaption>Level sets of the Hamiltonian function. All orbits are closed, and they correspond to periodic solutions of the Lotka-Volterra model.</figcaption>
</figure>
</div>
</div>
</div>
<p>Therefore, the curve <span class="math display">\[
\mathcal{H}(H(t),P(t)) = \mathcal{H}(H(0),P(0)),
\]</span></p>
<p>is a closed orbit of the system. Depending on the initial conditions, we end up with a different orbit, but all of them are closed. It still can be that as the period of revolution around the orbit is not finite. This can happen for homoclinic orbits, for instance (see <a href="IntroODE.html#fig-homoclinic" class="quarto-xref">Figure&nbsp;<span>A.1</span></a>.) We can exclude this option as follows: we define the angular coordinate as: <span class="math display">\[
\theta(t) = \arctan\Bigl( \frac{P(t)-P^*}{H(t)-H^*} \Bigr),
\]</span></p>
<p>which measures the angle of the vector <span class="math inline">\((H(t),P(t)) - E^*\)</span> with respect to the abscissa. The angular velocity is: <span class="math display">\[
\begin{split}
\theta'(t) &amp;= \frac{(H-H^*)P' - (P-P^*)H'}{(H-H^*)^2 - (P-P^*)^2} \\
&amp;= \frac{\gamma a P (H-H^*)^2 + a H(P-P^*)^2}{(H-H^*)^2 - (P-P^*)^2} \\
&amp;\ge \min\{ \gamma a \min P, a \min H \} &gt; 0,
\end{split}
\]</span></p>
<p>where <span class="math inline">\(\min P\)</span> and <span class="math inline">\(\min H\)</span> are taken on the curve and are certainly positive thanks to the logarithmic term in <span class="math inline">\(\mathcal{H}\)</span>. Since the velocity is strictly positive, and the length of the curve is finite, the period must be finite as well.</p>
<p>In conclusion, all orbits are periodic. The temporal behavior of <span class="math inline">\(P(t)\)</span> and <span class="math inline">\(P(t)\)</span> is then periodic, as observed in data.</p>
<div id="43aeb033" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>sns.set_theme(<span class="st">"notebook"</span>, style<span class="op">=</span><span class="st">"whitegrid"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>r,mu,a,gamma <span class="op">=</span> <span class="fl">0.5</span>,<span class="fl">1.0</span>,<span class="fl">1.0</span>,<span class="fl">0.75</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> t,y: [ r<span class="op">*</span>y[<span class="dv">0</span>]<span class="op">-</span>a<span class="op">*</span>y[<span class="dv">0</span>]<span class="op">*</span>y[<span class="dv">1</span>], <span class="op">-</span>mu<span class="op">*</span>y[<span class="dv">1</span>] <span class="op">+</span> gamma<span class="op">*</span>a<span class="op">*</span>y[<span class="dv">1</span>]<span class="op">*</span>y[<span class="dv">0</span>] ]</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> [<span class="fl">3.0</span>,<span class="fl">2.0</span>]</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>sol <span class="op">=</span> solve_ivp(f, [<span class="dv">0</span>,<span class="dv">40</span>], y0, rtol<span class="op">=</span><span class="fl">1e-8</span>, atol<span class="op">=</span><span class="fl">1e-10</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>ax.plot(sol.t,sol.y.T)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>ax.legend([<span class="st">'$H(t)$'</span>, <span class="st">'$P(t)$'</span>])</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'time'</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05_LotkaVolterra_files/figure-html/cell-3-output-1.png" width="561" height="435" class="figure-img"></p>
<figcaption>Example of solution of the Lotka-Volterra model</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="the-fishery-problem" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="the-fishery-problem"><span class="header-section-number">5.2.3</span> The fishery problem</h3>
<p>Now we have a model that we can use to address D’Ancona question. If we regularly capture some predators and preys (both are fishes, we can catch both), their quantity is going to be proportional to the actual level of population. So, we can check the average value of <span class="math inline">\(H\)</span> and <span class="math inline">\(P\)</span>.</p>
<p>Let <span class="math inline">\(T\)</span> be the period of an orbit. Then we’ d like to compute <span class="math display">\[
\begin{aligned}
\bar{H} &amp;= \frac{1}{T}\int_0^T H(t)\,\mathrm{d}t, \\
\bar{P} &amp;= \frac{1}{T}\int_0^T P(t)\,\mathrm{d}t.
\end{aligned}
\]</span></p>
<p>Moreover, <span class="math display">\[
\begin{aligned}
\int_0^T \frac{H'}{H}\,\mathrm{d}t &amp;= \int_0^T \frac{H F(P)}{H}\,\mathrm{d}t = \int_0^T (r - a P) \,\mathrm{d}t = r T - a T \bar{P}, \\
\int_0^T \frac{P'}{P}\,\mathrm{d}t &amp;= \int_0^T \frac{P G(H)}{P}\,\mathrm{d}t = \int_0^T (-\mu + \gamma a H) \,\mathrm{d}t = -\mu T + \gamma a T \bar{H}.
\end{aligned}
\]</span></p>
<p>Since the solution is periodic, <span class="math inline">\(H(T)=H(0)\)</span> and <span class="math inline">\(P(t)=P(0)\)</span>. Hence: <span class="math display">\[
\begin{aligned}
\int_0^T \frac{H'}{H}\,\mathrm{d}t &amp;= \int_{H(0)}^{H(T)} \frac{1}{H}\,\mathrm{d}H = \ln \frac{H(T)}{H(0)} = 0, \\
\int_0^T \frac{P'}{P}\,\mathrm{d}t &amp;= \int_{P(0)}^{P(T)} \frac{1}{P}\,\mathrm{d}P = \ln \frac{P(T)}{P(0)} = 0.
\end{aligned}
\]</span></p>
<p>We end up with the system: <span class="math display">\[
\left\{\begin{aligned}
r - a \bar{P} &amp;= 0, \\
-\mu + \gamma a \bar{H} &amp;= 0,
\end{aligned}\right.
\]</span></p>
<p>from which we deduce that <span class="math display">\[
\bar{H} = \frac{\mu}{\gamma a} = H^*, \quad \bar{P} = \frac{r}{a} = P^*.
\]</span></p>
<p>The average quantities match the value of the equilibrium, <em>irrespective</em> of the initial condition! This result is not obvious. Biologically, the system has an equilibrium, although non constant in time.</p>
<p>Now, we introduce harvesting (fishing). Consider a parameter <span class="math inline">\(E \ge 0\)</span>, called the <em>effort</em>. This is an abstract concept mutuated from bioeconomics. A small or zero effort means that we do not harvest much, a large effort is the opposite. We modify the Lotka-Volterra system as follows: <span class="math display">\[
\left\{\begin{aligned}
H' &amp;= r H - a H P - \alpha E H, \\
P' &amp;= -\mu P + \gamma a H P - \beta E P,
\end{aligned}\right.
\]</span></p>
<p>where <span class="math inline">\(\alpha, \beta &gt; 0\)</span> are the <em>returns</em> per unit effort. That is, <span class="math inline">\(\alpha H \Delta t\)</span> is the number of preys obtained in <span class="math inline">\(\Delta t\)</span> units of time per unit effort. If we rewrite the system as follows: <span class="math display">\[
\left\{\begin{aligned}
H' &amp;= H (r - \alpha E - a P) = H (\tilde{r} - a P), \\
P' &amp;= P (-\mu P - \beta E + \gamma a H) = P(-\tilde{\mu} + \gamma a H),
\end{aligned}\right.
\]</span></p>
<p>with <span class="math inline">\(\tilde{r} = r - \alpha E\)</span> and <span class="math inline">\(\tilde{\mu} = \mu + \beta E\)</span>, the system is identical to the original one, provided that <span class="math inline">\(r &gt; \alpha E\)</span>. The new equilibrium <span class="math inline">\(E^{**} = (H^{**}, P^{**})\)</span> reads: <span class="math display">\[
H^{**} = \frac{\tilde{\mu}}{\gamma a} =\frac{\mu + \beta E}{\gamma a}, \quad
P^{**} = \frac{\tilde{r}}{a} =\frac{r - \alpha E}{a}.
\]</span></p>
<p>Thus, for <span class="math inline">\(E &gt; 0\)</span> we are simply shifting the equilibrium. But the equilibrium is also the average value of <span class="math inline">\(H(t)\)</span> and <span class="math inline">\(P(t)\)</span> over the period, thus we should observe the same shift in the data. As a matter of fact, for <span class="math inline">\(E &gt; 0\)</span>, the number of prey diminishes, but the number of predator increases! During the World War I, fishery reduced, so <span class="math inline">\(E\)</span> decreased: an increase of predators occurred, as observed by D’Ancona.</p>
<p>In conclusion, Volterra stated the following laws:</p>
<ol type="1">
<li>the fluctuations of the two species are periodic;</li>
<li>the average number of individuals over the period is conserved and does not depend on the initial datum;</li>
<li>(also called <em>Volterra’s principle</em>) with <span class="math inline">\(E&gt;0\)</span>, the average number of preys increases and the number of predators decreases.</li>
</ol>
<p>Volterra’s principle is important in ecology. It somewhat paradoxically explain why, when applying non-specific killing (e.g., pesticides) some species may actually increase instead of decreasing.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-elton1942ten" class="csl-entry" role="listitem">
Elton, Charles, and Mary Nicholson. 1942. <span>“The Ten-Year Cycle in Numbers of the Lynx in Canada.”</span> <em>The Journal of Animal Ecology</em>, 215–44. <a href="https://doi.org/10.2307/1358">https://doi.org/10.2307/1358</a>.
</div>
<div id="ref-ip14" class="csl-entry" role="listitem">
Iannelli, Mimmo, and Andrea Pugliese. 2014. <em>An Introduction to Mathematical Population Dynamics</em>. Vol. 79. Springer. <a href="https://strutture-provincia.primo.exlibrisgroup.com/permalink/39SBT_INST/ghkipk/alma991006883209706186">https://strutture-provincia.primo.exlibrisgroup.com/permalink/39SBT_INST/ghkipk/alma991006883209706186</a>.
</div>
<div id="ref-volterra1932" class="csl-entry" role="listitem">
Volterra, Vito. 1932. <em>Leçons Sur La Théorie Mathématique de La Lutte Pour La Vie</em>. Edited by Gauthier-Villars et Cie Éditeurs. Paris. <a href="https://matematicaitaliana.sns.it/opere/427/">https://matematicaitaliana.sns.it/opere/427/</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./04_Predation.html" class="pagination-link" aria-label="Predation models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Predation models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06_Gause.html" class="pagination-link" aria-label="Gause type models">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Gause type models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>