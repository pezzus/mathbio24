<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-10-09">

<title>System of ODEs – Mathematical Biology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Laboratories/01_ODE_Integration/lab_ODEinteg.html" rel="next">
<link href="../Assignments/03_spruce.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Assignments/01_recap_ODEs.html">Assignments</a></li><li class="breadcrumb-item"><a href="../Assignments/04_systems.html">System of ODEs</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Mathematical Biology</a> 
        <div class="sidebar-tools-main">
    <a href="../Mathematical-Biology.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Lectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01_Bathtub.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Bathtub model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_Population.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Population dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Logistic model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_Predation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Predation models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05_LotkaVolterra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Lotka-Volterra model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06_Gause.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Gause type models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07_RM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Rosenzweig-MacArthur model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Assignments/01_recap_ODEs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving ODEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Assignments/02_population.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Population dynamics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Assignments/03_spruce.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Assignments/04_systems.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">System of ODEs</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Labs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Laboratories/01_ODE_Integration/lab_ODEinteg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 01: Numerical integration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Laboratories/02_Predation/lab_Predation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 02: Predation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Laboratories/03_Bifurcations/lab_Bifurcations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 03: Bifurcations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Laboratories/04_Chaos/lab_chaos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 04: Chaos</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../IntroODE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Introduction to ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bifurcations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Introduction to bifurcations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Laboratories/00_Intro_Matlab/introMATLAB.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Introduction to MATLAB</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#linear-dynamics" id="toc-linear-dynamics" class="nav-link active" data-scroll-target="#linear-dynamics">Linear dynamics</a></li>
  <li><a href="#phase-portraits" id="toc-phase-portraits" class="nav-link" data-scroll-target="#phase-portraits">Phase portraits</a></li>
  <li><a href="#double-well-potential" id="toc-double-well-potential" class="nav-link" data-scroll-target="#double-well-potential">Double-well potential</a></li>
  <li><a href="#gone-with-the-wind" id="toc-gone-with-the-wind" class="nav-link" data-scroll-target="#gone-with-the-wind">Gone with the Wind</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Assignments/01_recap_ODEs.html">Assignments</a></li><li class="breadcrumb-item"><a href="../Assignments/04_systems.html">System of ODEs</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">System of ODEs</h1>
<p class="subtitle lead">Assignment 4</p>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 9, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 15, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="linear-dynamics" class="level2">
<h2 class="anchored" data-anchor-id="linear-dynamics">Linear dynamics</h2>
<p>Consider the linear system <span class="math inline">\(\mathbf{v}' = \mathbf{A}\mathbf{v}\)</span> where <span class="math display">\[
\mathbf{A} = \begin{pmatrix} -3 &amp; 2 \\ -2 &amp; 2 \end{pmatrix}.
\]</span></p>
<ol type="1">
<li>Find the eigenvalues and eigenvectors of <span class="math inline">\(\mathbf{A}\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We need to find <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\mathbf{v}\)</span> such that <span class="math inline">\(\mathbf{A}\mathbf{v} = \lambda\mathbf{v}\)</span>. First, the eigenvalues roots of <span class="math display">\[
\det(\mathbf{A}-\lambda\mathbf{I}) = (-3-\lambda)(2-\lambda)+4 = \lambda^2 + \lambda - 2.
\]</span></p>
<p>Also note that <span class="math inline">\(\det(\mathbf{A}-\lambda\mathbf{I}) = \lambda^2 - \operatorname{tr}\mathbf{A}\lambda + \det\mathbf{A}\)</span>. The eigenvalues are: <span class="math display">\[
\lambda_1 = -2, \quad \lambda_2 = 1.
\]</span></p>
<p>For the eigenvectors we have: <span class="math display">\[
\begin{aligned}
\mathbf{A}\mathbf{v}_1 &amp;= \lambda_1\mathbf{v}_1 = -2 \mathbf{v}_1, \\
\mathbf{A}\mathbf{v}_2 &amp;= \lambda_2\mathbf{v}_2 = 1 \mathbf{v}_2.
\end{aligned}
\]</span></p>
<p>We see that a possible choice of eigenvectors is <span class="math display">\[
\mathbf{v}_1 = \begin{bmatrix} 2 \\ 1 \end{bmatrix},
\quad
\mathbf{v}_2 = \begin{bmatrix} 1 \\ 2 \end{bmatrix}.
\]</span></p>
</div>
</div>
</div>
<ol start="2" type="1">
<li>Compute the matrix exponential of <span class="math inline">\(t\mathbf{A}\)</span> and the transition matrix.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The matrix <span class="math inline">\(\mathbf{A}\)</span> is diagonalizable. Thus, the matrix exponential is: <span class="math display">\[
e^{t\mathbf{A}} = \mathbf{V}e^{t\Lambda}\mathbf{V}^{-1}
\]</span></p>
<p>where <span class="math inline">\(\Lambda = \operatorname{diag}\{\lambda_1, \lambda_2 \}\)</span>. The matrix <span class="math inline">\(\mathbf{V}\)</span> and its inverse are: <span class="math display">\[
\mathbf{V} = \begin{bmatrix} \mathbf{v}_1 \;|\; \mathbf{v}_2 \end{bmatrix}
= \begin{bmatrix} 2 &amp; 1 \\ 1 &amp; 2 \end{bmatrix},
\quad
\mathbf{V}^{-1} = \frac{1}{3} \begin{bmatrix} 2 &amp; -1 \\ -1 &amp; 2 \end{bmatrix}.
\]</span></p>
<p>So we get: <span class="math display">\[
\begin{split}
e^{t\mathbf{A}} &amp;= \begin{bmatrix} 2 &amp; 1 \\ 1 &amp; 2 \end{bmatrix}
\begin{bmatrix} e^{-2t} &amp; 0 \\ 0 &amp; e^t \end{bmatrix}
\frac{1}{3} \begin{bmatrix} 2 &amp; -1 \\ -1 &amp; 2 \end{bmatrix} \\
&amp;= \frac{1}{3} \begin{bmatrix} 4 e^{-2t} - e^t &amp; 2( e^t - e^{-2t}) \\ 2( e^{-2t} - e^t) &amp; 4 e^t - e^{-2t} \end{bmatrix}.
\end{split}
\]</span></p>
<p>The transition matrix is just <span class="math inline">\(\mathbf{W}(t,s) = e^{(t-s)\mathbf{A}}\)</span>.</p>
</div>
</div>
</div>
<ol start="3" type="1">
<li>How can we approximate the behaviour of solutions for different initial conditions?</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Since we have the transition matrix, the solution for <span class="math inline">\(\mathbf{y}(0)=\mathbf{y}_0\)</span> is: <span class="math display">\[
\mathbf{y}(t) = \mathbf{W}(t,0)\mathbf{y}_0 = e^{t\mathbf{A}}\mathbf{y}_0.
\]</span></p>
</div>
</div>
</div>
<ol start="4" type="1">
<li>Find the equilibrium of the ODE and compute the stable and unstable manifold. Draw them on the phase portrait. Note, by definition the stable and unstable manifolds are <span class="math display">\[
\begin{aligned}
\mathcal{W}^s(\mathbf{y}^*) &amp;= \bigl\{ \mathbf{y}_0\in\mathbb{R}^2\colon \lim_{t\to+\infty}\boldsymbol{\phi}(t,\mathbf{y}_0) = \mathbf{y}^* \bigr\}, \\
\mathcal{W}^u(\mathbf{y}^*) &amp;= \bigl\{ \mathbf{y}_0\in\mathbb{R}^2\colon \lim_{t\to-\infty}\boldsymbol{\phi}(t,\mathbf{y}_0) = \mathbf{y}^* \bigr\}.
\end{aligned}
\]</span></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For this ODE we know the flow <span class="math inline">\(\boldsymbol{\phi}(t,\mathbf{y}_0)\)</span> explicitly: <span class="math display">\[
\boldsymbol{\phi}(t,\mathbf{y}_0) = e^{t\mathbf{A}}\mathbf{y}_0 = \mathbf{V}e^{t\Lambda}\mathbf{V}^{-1}\mathbf{y}_0.
\]</span></p>
<p>Thus the limit is: <span class="math display">\[
\lim_{t\to\pm\infty} \boldsymbol{\phi}(t,\mathbf{y}_0) = \mathbf{V} \Bigl( \lim_{t\to\pm\infty} e^{t\Lambda}\Bigr) \mathbf{V}^{-1}\mathbf{y}_0.
\]</span></p>
<p>The limit between parenthesis is a diagonal matrix formally equal to: <span class="math display">\[
\begin{aligned}
\lim_{t\to+\infty} e^{t\Lambda} &amp;= \operatorname{diag}\{ 0, +\infty \}, \\
\lim_{t\to-\infty} e^{t\Lambda} &amp;= \operatorname{diag}\{ +\infty, 0 \}.
\end{aligned}
\]</span></p>
<p>For the stable manifold <span class="math inline">\(\mathcal{W}^s\)</span>, the limit is <span class="math inline">\(\mathbf{y}^* = \mathbf{0}\)</span> only if <span class="math display">\[
\mathbf{V}^{-1}\mathbf{y}_0 = \begin{bmatrix} \alpha \\ 0 \end{bmatrix}
\quad\Rightarrow\quad
\mathbf{y}_0 = \alpha \mathbf{v}_1,
\]</span></p>
<p>for some <span class="math inline">\(\alpha\in\mathbb{R}\)</span>, otherwise the second component of <span class="math inline">\(\mathbf{V}^{-1}\mathbf{y}_0\)</span> diverges. Similarly for the unstable manifold, we get that <span class="math inline">\(\mathbf{y}_0 = \alpha \mathbf{v}_2\)</span>. In conclusion, the manifolds are the linear spaces: <span class="math display">\[
\begin{aligned}
\mathcal{W}^s(\mathbf{y}^*) &amp;= \bigl\{ \alpha \mathbf{v}_1 \colon \alpha\in\mathbb{R} \bigr\}, \\
\mathcal{W}^u(\mathbf{y}^*) &amp;= \bigl\{ \alpha \mathbf{v}_2 \colon \alpha\in\mathbb{R} \bigr\}.
\end{aligned}
\]</span></p>
<p>In other words, the stable manifold is the line parallel to the first eigenvector and passing through the origin, whereas the unstable manifold is the one parallel to the second eigenvector.</p>
</div>
</div>
</div>
<ol start="5" type="1">
<li>Qualitatively describe or draw the orbits.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Since we know the stable and unstable manifolds, we know already 2 orbits. Specifically, one orbit is along <span class="math inline">\(\mathcal{W}^s\)</span> with dynamic <span class="math inline">\(e^{\lambda_1 t} = e^{-2t}\)</span>, thus any non-zero point on <span class="math inline">\(\mathcal{W}^s\)</span> converges to zero with the above rate. Similarly, on the unstable manifold trajectories diverges with rate <span class="math inline">\(e^{\lambda_2 t} = e^t\)</span>.</p>
<p>For other initial conditions, the dynamic is a linear combination of the dynamic on the stable and unstable manifold. See the picture.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pplot_55.png" class="img-fluid figure-img"></p>
<figcaption>image</figcaption>
</figure>
</div>
<p><strong>Q3.6.</strong> Is the equilibrium <span class="math inline">\(\mathbf{y}^* = \mathbf{0}\)</span> stable?</p>
<p>The equilibrium is unstable, specifically a saddle point.</p>
</div>
</div>
</div>
</section>
<section id="phase-portraits" class="level2">
<h2 class="anchored" data-anchor-id="phase-portraits">Phase portraits</h2>
<p>Take a look at the following set of phase portraits:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phase_plots_exercise.png" class="img-fluid figure-img"></p>
<figcaption>Phase portraits</figcaption>
</figure>
</div>
<ol type="1">
<li>Find the phase portrait that <em>cannot</em> be from a linear ODE.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Case 4 cannot be from a linear system, because for a saddle the stable and unstable manifold should be linear.</p>
</div>
</div>
</div>
<ol start="2" type="1">
<li>For all the others, qualitatively describe the set of eigenvectors, eigenvalues, equilibria, and stability.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let us go case by case:</p>
<ol type="1">
<li><p>Here we have <span class="math inline">\(\lambda_1 &lt; 0\)</span> (real), and <span class="math inline">\(\lambda_2 = 0\)</span>. The first eigenvector <span class="math inline">\(\mathbf{v}_1\)</span> is almost vertical, whereas <span class="math inline">\(\mathbf{v}_2\)</span> is parallel to the line with equilibria. The kernel of <span class="math inline">\(\mathbf{A}\)</span> is generated by <span class="math inline">\(\mathbf{v}_2\)</span>. For instance, we could take <span class="math inline">\(\mathbf{v}_1 = [0,1]^T\)</span> and <span class="math inline">\(\mathbf{v}_2 = [1,1]^T\)</span>.</p></li>
<li><p>This is an asymptotically stable spiral. Thus, we have 2 complex conjugate eigenvalues, <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\bar{\lambda}\)</span>, with negative real part.</p></li>
<li><p>A center, as above but the real part is zero: <span class="math inline">\(\lambda_{1,2} = \pm i \omega\)</span> for some <span class="math inline">\(\omega\)</span>. An example is <span class="math inline">\(\mathbf{A} = \left(\begin{smallmatrix} 0 &amp; 01 \\ \omega^2 &amp; 0 \end{smallmatrix}\right)\)</span>.</p></li>
<li><p>Non linear.</p></li>
<li><p>Tricky one. We only have one eigenvector <span class="math inline">\(\mathbf{v}_1\)</span> associated with an asymptotically stable eigenvalue (real). The eigenvalue is double, that is the algebraic multiplicity is 2 (double root of the characteristic polynomial), but the geometrical multiplicity is 1. Recall that the geometrical multiplicity is the dimension of the eigenspace <span class="math inline">\(\ker(\lambda\mathbf{I} - \mathbf{A})\)</span>. Along <span class="math inline">\(\mathbf{v}_1\)</span> we approach the equilibrium as usual. Components orthogonal to <span class="math inline">\(\mathbf{v}_1\)</span> will also converge to the equilibrium as <span class="math inline">\(t e^{\lambda t}\)</span>. Take <span class="math inline">\(\mathbf{A}=\left(\begin{smallmatrix} a &amp; 1 \\ 0 &amp; a \end{smallmatrix}\right)\)</span> with <span class="math inline">\(a&lt;0\)</span> as an example.</p></li>
<li><p>Asymptotically stable equilibrium with two coincident eigenvalues, e.g., <span class="math inline">\(\mathbf{A} = \lambda \mathbf{I}\)</span> for some <span class="math inline">\(\lambda &lt; 0\)</span> real.</p></li>
</ol>
</div>
</div>
</div>
</section>
<section id="double-well-potential" class="level2">
<h2 class="anchored" data-anchor-id="double-well-potential">Double-well potential</h2>
<p>Consider the following ODE <span class="math display">\[
y'' = F(y) = y - y^3.
\]</span></p>
<ol type="1">
<li>Recast the problem as a system of ODEs.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We set <span class="math inline">\(y_1 = y\)</span> and <span class="math inline">\(y_2 = y' = y_1'\)</span>, so: <span class="math display">\[
\left\{\begin{aligned}
y_1' &amp;= y_2, \\
y_2' &amp;= y_1 - y_1^3 = F(y_1).
\end{aligned}\right.
\]</span></p>
</div>
</div>
</div>
<ol start="2" type="1">
<li>Find the Hamiltonian of the system. <em>Hint: use the potential energy.</em></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Since <span class="math inline">\(U(y_1) = -\frac{1}{2} y_1^2 + \frac{1}{4} y_1^4\)</span> is such that <span class="math inline">\(U' = -F\)</span>, we have the Hamiltonian: <span class="math display">\[
H(y_1,y_2) = \frac{1}{2} y_2^2 + U(y_1).
\]</span></p>
</div>
</div>
</div>
<ol start="3" type="1">
<li>Graphically represent the orbits in the phase plane for various choices of the initial energy. Are all orbits closed?</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Yes, orbits are all closed, because <span class="math inline">\(H\)</span> is bounded from below and <span class="math inline">\(H\to+\infty\)</span> as <span class="math inline">\(\|\mathbf{y}\|\to\infty\)</span>. So, <span class="math inline">\(H(y_1,y_2)=k\)</span> is always a closed curve if <span class="math inline">\(k &gt; \min_{\mathbf{y}} H\)</span>. Graphically:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="duffing.png" class="img-fluid figure-img"></p>
<figcaption>image</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ol start="4" type="1">
<li>Show that the system has 3 equilibria, two stable (not asymptotically) and one unstable.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can compute them by looking at stationary points of the Hamiltonian. We have 2 equilibria at <span class="math inline">\((\pm1,0)\)</span>, which are locally stable because the Hamiltonian is convex, and one saddle point at <span class="math inline">\((0,0)\)</span>. Note that linearization fails for this example, we can only deduce the stability from the phase portrait.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="duffing_eq.png" class="img-fluid figure-img"></p>
<figcaption>image</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ol start="5" type="1">
<li>The system has 2 <em>homoclinic orbits</em>, one on the left and one on the right of the origin. Homoclinic orbits look like periodic orbits, but with an infinite period. Try to describe what happens if you start close to the origin, and then you take the initial condition that tends to the origin. What does it happen to the solution?</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If we start close to the origin, we are on a periodic solution with some period <span class="math inline">\(T&gt;0\)</span>. The orbit has a shape close to the homoclinic orbit. If we start closer and closer, the orbit will tend to a drop-like shape (like the homoclinic) and the period will tend to <span class="math inline">\(\infty\)</span>.</p>
</div>
</div>
</div>
</section>
<section id="gone-with-the-wind" class="level2">
<h2 class="anchored" data-anchor-id="gone-with-the-wind">Gone with the Wind</h2>
<p><em>Based on exercise 7.2.19 from Strogatz (2015).</em></p>
<p>Rinaldi <em>et al.</em> (2013) used mathematical modeling to describe the stormy love affair between Scarlett O’Hara and Rhett Butler. The system reads: <span class="math display">\[
\left\{\begin{aligned}
R' &amp;= -R + A_S + kS e^{-S}, \\
S' &amp;= -S + A_R + kR e^{-R},
\end{aligned}\right.
\]</span></p>
<p>where <span class="math inline">\(R(t)\)</span> is Rhett’s love for Scarlett, and <span class="math inline">\(S(t)\)</span> is Scarlett’s love for Rhett. All parameters are positive.</p>
<p><em>Note: “Frankly, my dear, I don’t give a damn” is not a valid answer.</em></p>
<ol type="1">
<li>Interpret the three terms on the right hand side of each equation. What do they mean, romantically speaking? In particular, what does the functional form of the exponentials terms signify about how Rhett and Scarlett react to each other’s endearments?</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let us exclude for a moment the exponental terms. In this case, the equations are independent, with <span class="math inline">\(R\to A_S\)</span> and <span class="math inline">\(S\to A_R\)</span> at <span class="math inline">\(t\to\infty\)</span>. Thus, we can interpret <span class="math inline">\(A_S\)</span> as the asymptotic love of Rhett for Scarlett, in the absence of a feedback from Scarlett. The same is valid for Scarlett’s love for Rhett.</p>
<p>The exponential terms models the interaction between the two lovers. The function <span class="math inline">\(S e^{-S}\)</span> is as follows:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="explove.png" class="img-fluid figure-img"></p>
<figcaption>image</figcaption>
</figure>
</div>
<p>So, when <span class="math inline">\(S=0\)</span> (Scarlett has no interest for Rhett), this term is also zero, providing no contribution to Rhett’s love. But as soon as <span class="math inline">\(S\)</span> increases, Rhett’s love increases even more. The peak is for <span class="math inline">\(S=1\)</span>, after that too much love from Scarlett (<span class="math inline">\(S\gg 1\)</span>) has little effect in Rhett’s love. The situation is simmetric for Scarlett reaction to Rhett’s love.</p>
</div>
</div>
</div>
<ol start="2" type="1">
<li>Show that all trajectories that begin in the first quadrant <span class="math inline">\(R, S &gt; 0\)</span> stay in the first quadrant forever, and interpret that result psychologically.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The system is not in Kolmogorov form, but we can check whether the first quadrant is a trapping region. For <span class="math inline">\(S=0\)</span>, we have <span class="math inline">\(S' = A_R + kR e^{-R} &gt; 0\)</span>, so orbits can only enter. Similarly, for <span class="math inline">\(R=0\)</span>, we have <span class="math inline">\(R' = A_S + kS e^{-S} &gt; 0\)</span>. Thus, the axes of the first quadrant are inflow, thus if we start in the first quadrant, we cannot leave.</p>
<p>Psychologically, we could say that once they meet, they cannot avoid love between them. But I’m open to other interpretations.</p>
</div>
</div>
</div>
<ol start="3" type="1">
<li>Using Dulac’s criterion, prove that the model has no periodic solutions. <em>Hint: the simplest <span class="math inline">\(h(R,S)\)</span> you can think of will work.</em></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let us consider <span class="math inline">\(h\equiv 1\)</span>. We have: <span class="math display">\[
\nabla\cdot\mathbf{f} = -2 &lt; 0.
\]</span></p>
<p>The sign is constant, thus we cannot have limit cycles.</p>
</div>
</div>
</div>
<ol start="4" type="1">
<li>Using Phase Plane in Matlab, plot the phase portrait for the system, assuming parameter values <span class="math inline">\(A_S = 1.2\)</span>, <span class="math inline">\(A_R = 1\)</span>, and <span class="math inline">\(k=15\)</span>. Assuming that Rhett and Scarlett are indifferent when they meet, so that <span class="math inline">\(R(0)=S(0)=0\)</span>, plot the predicted trajectory for what happens in the first stage of their relationship. <em>Hint: don’t use the default range for the phase plane, increase it. If you spot a heart ❤️, it’s not on purpose.</em></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Scarlett.png" class="img-fluid figure-img"></p>
<figcaption>image</figcaption>
</figure>
</div>
<p>We have 3 equilibria, one saddle at the center and 2 stable and attractive equilibria. The unstable manifold of the saddle connects to the stable manifold of the equilibria, effectively providing a barrier in the lower left triangle of the phase plane. The stable manifold of the saddle roughly bisect the triangle.</p>
<p>Starting from <span class="math inline">\((0,0)\)</span>, we intially approach the saddle, thus the <span class="math inline">\(S\)</span> and <span class="math inline">\(R\)</span> are comparable (Scarlett loves Rhett as much as Rhett loves Scarlett), but then the orbit turns to the right, and reaches an equilibrium where Rhett’s love for Scarlett is much higher than Scarlett’s love for Rhett’s.</p>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../Assignments/03_spruce.html" class="pagination-link" aria-label="Predation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Predation</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../Laboratories/01_ODE_Integration/lab_ODEinteg.html" class="pagination-link" aria-label="Lab 01: Numerical integration">
        <span class="nav-page-text">Lab 01: Numerical integration</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>