<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-10-09">

<title>Lab 03: Bifurcations – Mathematical Biology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../Laboratories/04_Chaos/lab_chaos.html" rel="next">
<link href="../../Laboratories/02_Predation/lab_Predation.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../Laboratories/01_ODE_Integration/lab_ODEinteg.html">Labs</a></li><li class="breadcrumb-item"><a href="../../Laboratories/03_Bifurcations/lab_Bifurcations.html">Lab 03: Bifurcations</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Mathematical Biology</a> 
        <div class="sidebar-tools-main">
    <a href="../../Mathematical-Biology.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Lectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../01_Bathtub.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Bathtub model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../02_Population.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Population dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../03_Logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Logistic model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../04_Predation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Predation models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../05_LotkaVolterra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Lotka-Volterra model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../06_Gause.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Gause type models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../07_RM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Rosenzweig-MacArthur model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Assignments/01_recap_ODEs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving ODEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Assignments/02_population.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Population dynamics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Assignments/03_spruce.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Assignments/04_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">System of ODEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Assignments/05_predators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prey-predator systems</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Labs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Laboratories/01_ODE_Integration/lab_ODEinteg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 01: Numerical integration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Laboratories/02_Predation/lab_Predation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 02: Predation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Laboratories/03_Bifurcations/lab_Bifurcations.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Lab 03: Bifurcations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Laboratories/04_Chaos/lab_chaos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 04: Chaos</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../IntroODE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Introduction to ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../bifurcations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Introduction to bifurcations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Laboratories/00_Intro_Matlab/introMATLAB.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Introduction to MATLAB</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#installation-of-matcont" id="toc-installation-of-matcont" class="nav-link active" data-scroll-target="#installation-of-matcont">Installation of MatCont</a></li>
  <li><a href="#spruce-budworm-system" id="toc-spruce-budworm-system" class="nav-link" data-scroll-target="#spruce-budworm-system">Spruce-budworm system</a></li>
  <li><a href="#rosenzweig-macarthur-model" id="toc-rosenzweig-macarthur-model" class="nav-link" data-scroll-target="#rosenzweig-macarthur-model">Rosenzweig-MacArthur model</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../Laboratories/01_ODE_Integration/lab_ODEinteg.html">Labs</a></li><li class="breadcrumb-item"><a href="../../Laboratories/03_Bifurcations/lab_Bifurcations.html">Lab 03: Bifurcations</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Lab 03: Bifurcations</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 9, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 15, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<p>This exercise in based on <a href="https://sourceforge.net/projects/matcont/">MatCont</a>, a sophisticated software for computing bifurcation diagrams of system of ODEs and discrete maps. It is based on Matlab.</p>
<section id="installation-of-matcont" class="level2">
<h2 class="anchored" data-anchor-id="installation-of-matcont">Installation of MatCont</h2>
<p>The installation is easy, but it requires some care on macOS and Windows. In Matlab, try the following:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="va">unzip</span>(<span class="ss">'https://gitlab.utwente.nl/m7686441/matcont/-/archive/main/matcont-main.zip'</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="va">cd</span> <span class="va">matcont</span><span class="op">-</span><span class="va">main</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="va">matcont</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If the last command fails, then follow the instruction below and try again with the command <code>init</code>, only after <code>mex -setup</code> returns success.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">macOS</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Windows</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">GNU/Linux</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>You need to install the <a href="https://apps.apple.com/it/app/xcode/id497799835?l=en&amp;mt=12">XCode</a>, which is several GBs. After installation, open it once and follow the instruction to accept the license.</p>
<p>If you succeeded, then you should see in Matlab:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="va">mex</span> <span class="op">-</span><span class="va">setup</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="va">MEX</span> <span class="va">configured</span> <span class="va">to</span> <span class="va">use</span> <span class="ss">'Xcode with Clang'</span> <span class="kw">for</span> <span class="va">C</span> <span class="va">language</span> <span class="va">compilation</span>.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>An easy option is to install the Matlab add-on <a href="https://www.mathworks.com/matlabcentral/fileexchange/52848-matlab-support-for-mingw-w64-c-c-compiler">MiniGW</a> for Windows 10 or 11 64-bit. See the webpage. Try with <code>mex -setup</code> to check the compiler after installation.</p>
<p><strong>Note</strong>: if you already have Microsoft Visual C++ it should work already without MiniGW.</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>It should work out of the box. However, the compiler provided by your distribution might be too recent to work well with MEX. In this case, you might get some warnings during the compilation. On widespread distributions like Ubuntu it is usually fine.</p>
</div>
</div>
</div>
</section>
<section id="spruce-budworm-system" class="level2">
<h2 class="anchored" data-anchor-id="spruce-budworm-system">Spruce-budworm system</h2>
<p>We start with a simple model to get familiar with <code>MatCont</code>. Open the program by typing <code>matcont</code> in the program folder. (only after running <code>init</code> at least once.) You should see</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="matcont_init.png" class="img-fluid figure-img"></p>
<figcaption>The MatCont interface.</figcaption>
</figure>
</div>
<p>plus some other windows that you can ignore for now.</p>
<p>In this exercise we want to study the bifurcation diagram of the Spruce-Budworm ODE <span class="math display">\[
u'=f(u,\rho,q)=\rho u\Bigl(1-\frac{u}{q}\Bigr) - \frac{u^2}{1+u^2},
\]</span></p>
<p>with respect to the parameters <span class="math inline">\(\rho\)</span> and <span class="math inline">\(q\)</span>. Remember that we rescaled the ODE assuming: <span class="math display">\[
u(t) = \frac{N(t)}{\nu}, \quad \tau = \frac{\alpha P^*}{\nu} t, \quad \rho = \frac{r\nu}{\alpha P^*}, \quad q = \frac{K}{\nu},
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(N(t)\)</span> is the population of budworms,</li>
<li><span class="math inline">\(r\)</span> is the intrinsic growth rate,</li>
<li><span class="math inline">\(P^*\)</span> is the number of predators of the budworms (e.g., birds),</li>
<li><span class="math inline">\(\alpha\)</span> is the attack rate,</li>
<li><span class="math inline">\(K\)</span> is the carrying capacity,</li>
<li><span class="math inline">\(\nu\)</span> is the value of <span class="math inline">\(N\)</span> yielding half of the maximum killing rate.</li>
</ul>
<ol type="1">
<li><p>Create a new system <code>Select-&gt;System-&gt;New</code>. In the new window, compile as follows:</p>
<ul>
<li><strong>Name:</strong> <code>SpruceBudworm</code></li>
<li><strong>Coordinates:</strong> <code>u</code></li>
<li><strong>Parameters:</strong> <code>rho,q</code></li>
</ul>
<p>Put the first 3 derivatives to <code>symbolically</code>. (If <code>symbolically</code> is disabled, install the Symbolic Toolbox.)</p>
<p>Write the equation in the textbox at the bottom, using a natural language:</p>
<pre class="text"><code>u' = rho*u*(1-u/q)-u^2/(1+u^2)</code></pre>
<p>Press <code>OK</code>.</p>
<p>We should see something like this: <img src="Budworm.png" class="img-fluid" alt="Implementation of the budworm equation."></p></li>
<li><p>Now we compute an orbit. We start at <span class="math inline">\(t=0\)</span> with <span class="math inline">\(u(0)=0.1\)</span>. The initial parameters are: <span class="math inline">\(\rho=1\)</span> and <span class="math inline">\(q=8\)</span>.</p>
<p>We do as follows:</p>
<ol type="1">
<li><code>Type-&gt;Initial Point-&gt;Point</code></li>
<li>In <code>Starter</code>, we set the initial conditions and parameters</li>
<li>In <code>Methods</code>, reduce the tolerance for numerical integration</li>
<li>In the main window, <code>Compute-&gt;Forward</code>, then inspect <code>View Results</code>.</li>
</ol>
<p>To visualize the solution,</p>
<ol type="1">
<li><code>Window/Output-&gt;Graphic-&gt;2D Plot</code>,</li>
<li>Select in <code>Layout</code> time as ascissa and <span class="math inline">\(u\)</span> as ordinate,</li>
<li>In the plot window, <code>MatCont-&gt;Redraw Curve</code>.</li>
</ol>
<p>Clearly we are not yet at equilibrium. Go back and increase the integration time in <code>Methods</code>, then try again.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The first attempt should be like this:</p>
<p><img src="Budworm_orbit.png" class="img-fluid"></p>
<p>Increasing the final time gives:</p>
<p><img src="Budworm_eq.png" class="img-fluid"></p>
</div>
</div>
</div>
<ol start="3" type="1">
<li><p>Once we have reached an equilibrium, we can try to continue it with respect to <span class="math inline">\(\rho\)</span>.</p>
<p>Select as initial point the last integration point of the orbit: <code>Select-&gt;Initial Point</code>. You should notice that in the <code>Starter</code> window we now have different values.</p>
<p>To continue an equilibrium,</p>
<ol type="1">
<li><code>Type-&gt;Initial Point-&gt;Equilibrium</code></li>
<li><code>Type-&gt;Curve-&gt;Equilibrium</code></li>
<li>Select in <code>Starter</code> the parameter of interest, that is <span class="math inline">\(\rho\)</span> for us</li>
<li>In <code>Continuer</code> window, reduce the <code>MaxStepsize</code> to <code>0.02</code> and the <code>MaxNumPoints</code> to <code>100</code>. (<em>This is not strictly necessary, just to be safe.</em>)</li>
<li>In <code>Plot2D</code> (if not open, open it with <code>Window/Output-&gt;Graphic-&gt;2D Plot</code>) change the layout to parameter <code>rho</code> (range <span class="math inline">\([0,2]\)</span>) in the ascissa and <code>u</code> (range <span class="math inline">\([0,10]\)</span>) on the ordinate. Clear the plot.</li>
<li>In the main window, <code>Compute-&gt;Forward</code>.</li>
</ol>
<p>What do you observe?</p>
<p>Try now with <code>Compute-&gt;Backward</code> and then <code>Compute-&gt;Extend</code>. You should get a <em>Limit Point</em> (<code>LP</code> in MatCont). Continue to extend (on the left) the curve until you get another <code>LP</code> and a <em>Branch Point</em> (<code>BP</code>). Stop here.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We have</p>
<p><img src="Budworm_fwd.png" class="img-fluid"></p>
<p>For the forward integration, we have no bifurcation points.</p>
<p><img src="Budworm_bwd.png" class="img-fluid"></p>
<p>After backward continuation, we encounter 3 bifurcation points: 2 limit points (LP) and 1 branch point (BP). Their coordinates are</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Bifurcation</th>
<th><span class="math inline">\(u\)</span></th>
<th><span class="math inline">\(\rho\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>LP</td>
<td>3.71</td>
<td>0.469</td>
</tr>
<tr class="even">
<td>LP</td>
<td>1.19</td>
<td>0.579</td>
</tr>
<tr class="odd">
<td>BP</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>The figures can be found in the Data Browser.</p>
</div>
</div>
</div>
<ol start="4" type="1">
<li><p>In order to visualize the stability, you need to change the <code>Plot Properties</code>, and set what you prefer for <code>EP if unstable</code>, e.g., a dashed line. Redraw the previous plot and check which branch of the equilibrium curve is unstable.</p>
<p>Alternatively, try to plot in 3-D the parameter, the coordinate and the real part of the eigenvalue (navigate the <code>Layout</code> panel).</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="Budworm_color.png" class="img-fluid"> Note that the intermediate branch is unstable.</p>
</div>
</div>
</div>
<ol start="5" type="1">
<li><p>Try again with different values of <span class="math inline">\(q\)</span>, for instance <span class="math inline">\(q=1\)</span>, <span class="math inline">\(q=5\)</span> and <span class="math inline">\(q=10\)</span>.</p>
<p>One way to compute the initial equilibrium point is to start with a new orbit (<code>Select-&gt;Curve</code> and then <code>New</code>). Then you can repeat the above process. Do not clear the plot: we can keep multiple curves.</p>
<p>Do you observe limit points in all cases?</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>No, this is the case for <span class="math inline">\(q=1\)</span>: <img src="Budworm_q1.png" class="img-fluid"></p>
</div>
</div>
</div>
<ol start="6" type="1">
<li><p>It seems that for small <span class="math inline">\(q\)</span> there are no limit points, whereas for large <span class="math inline">\(q\)</span> we have 2 points. In particular, as we decrease <span class="math inline">\(q\)</span> the limit points get closer, thus we expect a collision. Such collision is another type of bifurcation, called <em>cusp bifurcation</em>, which has co-dimension 2. That is, it involves 2 parameters.</p>
<p>We can easily compute the cusp point in MatCont</p>
<ol type="1">
<li>Select an equilibrium curve with at least a limit point (<code>Select-&gt;Curve</code>)</li>
<li>Select the limit point (<code>Select-&gt;Initial Point</code>)</li>
<li>Select <code>Type-&gt;Initial Point-&gt;Limit Point</code></li>
<li>Select <code>Type-&gt;Curve-&gt;Limit Point</code></li>
<li>In the <code>Starter</code> window, we now have to select 2 parameters: select both <code>rho</code> and <code>q</code> (as active parameters, the box on the right.)</li>
</ol>
<p>Now we can compute the curve with <code>Compute-&gt;Backward</code> or <code>Compute-&gt;Forward</code>. Extend it a few times if necessary. Find <span class="math inline">\(\rho\)</span> and <span class="math inline">\(q\)</span> corresponding to the cusp.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Here is the cusp: <img src="Budworm_cusp.png" class="img-fluid"></p>
<p>The value of the bifurcation is <span class="math inline">\((\rho,q)=(0.650,5.196)\)</span>. So, for lower values of <span class="math inline">\(q\)</span> there is no folding, thus no limit points.</p>
</div>
</div>
</div>
<ol start="7" type="1">
<li><p>Try to visualize the plot in 3-D.</p>
<p>To get an idea of the function, consider <span class="math inline">\(\rho\in[0,1]\)</span>, <span class="math inline">\(q\in[0,10]\)</span> and <span class="math inline">\(u\in[0,10]\)</span>. Find the equation that implicitly define the surface of equilibria (parametrized in <span class="math inline">\(\rho\)</span> and <span class="math inline">\(q\)</span>).</p>
<p>Use the command <code>isosurface</code> as follows:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>[<span class="va">R</span> <span class="va">Q</span> <span class="va">U</span>] <span class="op">=</span> <span class="va">meshgrid</span>(<span class="fl">0.0</span><span class="op">:</span><span class="fl">0.01</span><span class="op">:</span><span class="fl">1</span><span class="op">,</span><span class="fl">0.0</span><span class="op">:</span><span class="fl">0.1</span><span class="op">:</span><span class="fl">10</span><span class="op">,</span><span class="fl">0</span><span class="op">:</span><span class="fl">0.1</span><span class="op">:</span><span class="fl">10</span>)<span class="op">;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="va">V</span> <span class="op">=</span> <span class="op">...;</span> <span class="co">% &lt;- EDIT!</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="va">p</span> <span class="op">=</span> <span class="va">patch</span>(<span class="va">isosurface</span>(<span class="va">R</span><span class="op">,</span><span class="va">Q</span><span class="op">,</span><span class="va">U</span><span class="op">,</span><span class="va">V</span><span class="op">,</span><span class="fl">0.0</span>))<span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="va">isonormals</span>(<span class="va">R</span><span class="op">,</span><span class="va">Q</span><span class="op">,</span><span class="va">U</span><span class="op">,</span><span class="va">V</span><span class="op">,</span><span class="va">p</span>)<span class="op">;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="va">p</span>.<span class="va">FaceColor</span> <span class="op">=</span> <span class="ss">'red'</span><span class="op">;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="va">p</span>.<span class="va">EdgeColor</span> <span class="op">=</span> <span class="ss">'none'</span><span class="op">;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="va">daspect</span>([<span class="fl">1</span> <span class="fl">10</span> <span class="fl">10</span>])</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="va">view</span>(<span class="fl">3</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="va">camlight</span><span class="op">;</span> <span class="va">lighting</span> <span class="va">phong</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The function should be</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode matlab line-numbers code-with-copy"><code class="sourceCode matlab"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="va">V</span> <span class="op">=</span> <span class="va">RHO</span><span class="op">.*</span>(<span class="fl">1</span><span class="op">-</span><span class="va">U</span><span class="op">./</span><span class="va">Q</span>) <span class="op">-</span> <span class="va">U</span><span class="op">./</span>(<span class="fl">1</span><span class="op">+</span><span class="va">U</span><span class="op">.^</span><span class="fl">2</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You should see this: <img src="Budworm_3D.png" class="img-fluid"></p>
<p>If you don’t get it, MatCont is messing up with Matlab plotting. Try closing MatCont (no worries, the last state is saved.)</p>
</div>
</div>
</div>
<ol start="8" type="1">
<li>With the 3-D plot at hands, with a fixed value of <span class="math inline">\(q\)</span>, explain the effect of hysteresis by imaging a “person moving on the landscape”. What does the ridge of limit points represent? And the cusp?</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For a fixed value of <span class="math inline">\(\rho\)</span> and <span class="math inline">\(q\)</span>, the equilibrium is exactly on the surface. Since we can have more than one intersection (in particular in the bistable region), there could exist multiple equilibria.</p>
<p>For a fixed value of <span class="math inline">\(q\)</span>, but taking <span class="math inline">\(\rho\)</span> variable, we are taking sections of the surface with the plane <span class="math inline">\(q=\bar{q}\)</span>. Here, we may get the sigmoidal curve of equilibria, or just a curve with no bifurcations. In the 3D plot, the ridge of the “cliff” corresponds to limit points (and the same for the back face).</p>
<p>The top of the cliff is the outbreak region, the bottom is the refuge. So, we get the hysteresis by first falling off the cliff, then walking in the shaded region, and go up again from behind (ok, this is perhaps far fetched as an analogy…)</p>
<p>Another interesting path, after falling down, is to walk towards lower values of <span class="math inline">\(q\)</span>, where there is no cliff. Then we can climb again <em>without</em> the need of undergoing the bifurcation.</p>
</div>
</div>
</div>
</section>
<section id="rosenzweig-macarthur-model" class="level2">
<h2 class="anchored" data-anchor-id="rosenzweig-macarthur-model">Rosenzweig-MacArthur model</h2>
<p>A sufficiently complex prey-predator model is the following: <span class="math display">\[
\left\{\begin{aligned}
u' &amp;= u \Bigl(\rho (1-u) - \frac{\alpha\delta v}{1+\delta u}\Bigr), \\
v' &amp;= v\Bigl(-1 + \frac{\alpha\delta u}{1+\delta u}\Bigr),
\end{aligned}\right.
\]</span></p>
<p>where <span class="math inline">\(u(t)\)</span> and <span class="math inline">\(v(t)\)</span> are the (non-dimensionalized) number of preys and predators, respectively.</p>
<ol type="1">
<li>Implement the model in MatCont and integrate a trajectory <span class="math inline">\(\alpha = 3\)</span>, <span class="math inline">\(\rho = 1\)</span> and with initial conditions <span class="math inline">\(u(0)=0.9\)</span> and <span class="math inline">\(v(0)=0.9\)</span>. As integration time put a large number, say <span class="math inline">\(T=100\)</span>. Try different values of <span class="math inline">\(\delta\in[0,5]\)</span>, and discuss the behaviour of the system. <em>Hint: you can plot multiple trajectories on the same graph. Try to visualize the phase portrait.</em></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is what we get for <span class="math inline">\(\delta=1\)</span>. The equilibrium is at <span class="math inline">\((u,v) = (0.5,0.25)\)</span>. <img src="RM_traj.png" class="img-fluid"> For larger values of <span class="math inline">\(\delta\)</span> we may converge towards the carrying capacity.</p>
<p>Note: don’t call the parameter <span class="math inline">\(\alpha\)</span> with <code>alpha</code>, MatCont will complain. Use <code>alph</code>, for instance.</p>
</div>
</div>
</div>
<ol start="2" type="1">
<li>Approximate the equilibrium <span class="math inline">\(E^*\)</span>, intersection of the two non-trivial nullcline, for <span class="math inline">\(\delta = 0.6\)</span>. Then, continue the equilibrium with respect to <span class="math inline">\(\delta\)</span>. How many bifurcation point do you observe? Visualize the diagram in the coordinates <span class="math inline">\((\delta,v^*)\)</span> and discuss it.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>After integration for <span class="math inline">\(\delta=0.6\)</span>, we have: <img src="RM_d0.6.png" class="img-fluid"> After continuing the equilibrium with respect to <span class="math inline">\(\delta\)</span> we have: <img src="RM_continue.png" class="img-fluid"> Notice that we encounter a Hopf bifurcation for <span class="math inline">\(\delta = 2\)</span>.</p>
</div>
</div>
</div>
<ol start="3" type="1">
<li>Is the equilibrium <span class="math inline">\(E^*\)</span> always a focus? <em>Hint: plot the imaginary part of one eigenvalue with respect to <span class="math inline">\(\delta\)</span>.</em></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="RM_eig1.png" class="img-fluid"> No, for <span class="math inline">\(\delta\)</span> small the eigenvalue is only real.</p>
</div>
</div>
</div>
<ol start="4" type="1">
<li><p>At some value of <span class="math inline">\(\delta\)</span> (which one?) there is a <em>Hopf</em> (<code>H</code>) bifurcation. It means that from the equilibrium we should expect the emergence of a limit cycle. Select as initial point the Hopf point. Then do:</p>
<ol type="1">
<li><code>Type-&gt;Initial Point-&gt;Hopf</code></li>
<li><code>Type-&gt;Curve-&gt;Limit Cycle</code></li>
<li>In <code>Starter</code>, select <code>delta</code> and <code>period</code> as continuation parameters</li>
<li><code>Compute-&gt;Backward</code> (or forward, it may vary)</li>
</ol>
<p>Try to visualize the limit cycles in 3-D, using the coordinates <span class="math inline">\((\rho,u^*,v^*)\)</span>. What’s the period of the cycle at the end of the branch?</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="RM_cycle.png" class="img-fluid"> We see that the limit cycle increases in size as <span class="math inline">\(\delta\)</span> increases.</p>
</div>
</div>
</div>
<ol start="5" type="1">
<li>Define a user function (<code>Select-&gt;System-&gt;Manage Userfunctions</code>) to monitor when <span class="math inline">\(\delta = 2.5\)</span> (for instance, <code>res=delta-2.5</code>). Once defined, activate it in the <code>Starter</code> window when continuing the Hopf bifurcation into a limit cycle. Find the period of the cycle for <span class="math inline">\(\delta = 2.5\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="RM_myfun.png" class="img-fluid"> <img src="RM_period.png" class="img-fluid"></p>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../Laboratories/02_Predation/lab_Predation.html" class="pagination-link" aria-label="Lab 02: Predation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Lab 02: Predation</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../Laboratories/04_Chaos/lab_chaos.html" class="pagination-link" aria-label="Lab 04: Chaos">
        <span class="nav-page-text">Lab 04: Chaos</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>