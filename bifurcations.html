<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Appendix B — Introduction to bifurcations – Mathematical Biology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Laboratories/00_Intro_Matlab/introMATLAB.html" rel="next">
<link href="./IntroODE.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./IntroODE.html">Appendices</a></li><li class="breadcrumb-item"><a href="./bifurcations.html"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Introduction to bifurcations</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Mathematical Biology</a> 
        <div class="sidebar-tools-main">
    <a href="./Mathematical-Biology.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Lectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Bathtub.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Bathtub model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Population.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Population dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Logistic model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Predation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Predation models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_LotkaVolterra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Lotka-Volterra model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Gause.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Gause type models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_RM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Rosenzweig-MacArthur model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_MichaelinMenten.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Michaelin-Menten law</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_FastSlow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Fast-Slow systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignments/01_recap_ODEs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving ODEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignments/02_population.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Population dynamics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignments/03_spruce.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignments/04_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">System of ODEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignments/05_predators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prey-predator systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignments/06_reactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reactions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Labs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Laboratories/01_ODE_Integration/lab_ODEinteg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 01: Numerical integration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Laboratories/02_Predation/lab_Predation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 02: Predation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Laboratories/03_Bifurcations/lab_Bifurcations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 03: Bifurcations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Laboratories/04_Chaos/lab_chaos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 04: Chaos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Laboratories/05_Feedbacks/lab_feedback.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 05: Feedback loops</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IntroODE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Introduction to ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bifurcations.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Introduction to bifurcations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Laboratories/00_Intro_Matlab/introMATLAB.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Introduction to MATLAB</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background"><span class="header-section-number">B.1</span> Background</a></li>
  <li><a href="#structural-stability" id="toc-structural-stability" class="nav-link" data-scroll-target="#structural-stability"><span class="header-section-number">B.2</span> Structural stability</a></li>
  <li><a href="#bifurcations" id="toc-bifurcations" class="nav-link" data-scroll-target="#bifurcations"><span class="header-section-number">B.3</span> Bifurcations</a></li>
  <li><a href="#continuation-of-equilibria" id="toc-continuation-of-equilibria" class="nav-link" data-scroll-target="#continuation-of-equilibria"><span class="header-section-number">B.4</span> Continuation of equilibria</a></li>
  <li><a href="#sec-tangbif" id="toc-sec-tangbif" class="nav-link" data-scroll-target="#sec-tangbif"><span class="header-section-number">B.5</span> Tangent bifurcation</a></li>
  <li><a href="#sec-transbif" id="toc-sec-transbif" class="nav-link" data-scroll-target="#sec-transbif"><span class="header-section-number">B.6</span> Transcritical bifurcation</a></li>
  <li><a href="#hopf-bifurcation" id="toc-hopf-bifurcation" class="nav-link" data-scroll-target="#hopf-bifurcation"><span class="header-section-number">B.7</span> Hopf bifurcation</a></li>
  <li><a href="#limit-cycle-tangent-bifurcation" id="toc-limit-cycle-tangent-bifurcation" class="nav-link" data-scroll-target="#limit-cycle-tangent-bifurcation"><span class="header-section-number">B.8</span> Limit cycle tangent bifurcation</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./IntroODE.html">Appendices</a></li><li class="breadcrumb-item"><a href="./bifurcations.html"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Introduction to bifurcations</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Appendix B — Introduction to bifurcations</h1>
</div>



<div class="quarto-title-meta">

    
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 13, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="background" class="level2" data-number="B.1">
<h2 data-number="B.1" class="anchored" data-anchor-id="background"><span class="header-section-number">B.1</span> Background</h2>
<p>As we have seen, dynamical system often depend on parameters. For instance, the spruce budworm model <span class="math display">\[
u' = \rho\Bigl( 1 - \frac{u}{q} \Bigr) - \frac{u^2}{1+u^2},
\]</span></p>
<p>depends on two parameters, <span class="math inline">\(\rho&gt;0\)</span> and <span class="math inline">\(q&gt;0\)</span>. The number of equilibria and their stability will depend on the parameters. However, most of the time a change of a parameter has little effect on the phase portrait: equilibria barely move, their stability is unchanged. In this case we say that the system is <em>topologically stable</em>. Otherwise, like for <span class="math inline">\(\rho=\rho_1\)</span> or <span class="math inline">\(\rho = \rho_2\)</span>, we have a <em>bifurcation</em>.</p>
<p>Another example we have seen is the Gause-type prey-predator model: <span class="math display">\[
\left\{\begin{aligned}
u' &amp;= \rho u(1-u) - \frac{\alpha\delta u v}{1+\delta u}, \\
v' &amp;= - v + \frac{\alpha\delta u v}{1+\delta u},
\end{aligned}\right.
\]</span></p>
<p>where we have 3 parameters. For <span class="math inline">\(\delta = \frac{1}{\alpha-1}\)</span> or <span class="math inline">\(\delta = \frac{\alpha+1}{\alpha-1}\)</span> we also have bifurcations.</p>
<p>In general, a parametric dynamical system is an equation of the form <span class="math display">\[
\mathbf{y}' = \mathbf{f}(\mathbf{y},\mathbf{p}),
\]</span></p>
<p>where <span class="math inline">\(\mathbf{p}\in\mathbb{R}^m\)</span> is the set of parameters. For the spruce budworm equation, <span class="math inline">\(\mathbf{p} = (\rho,q)\)</span>. Here, we are only focusing on the case <span class="math inline">\(m = 1\)</span>, when <span class="math inline">\(\mathbf{p}\)</span> is a scalar. Bifurcations occuring in this case are of co-dimension 1.</p>
</section>
<section id="structural-stability" class="level2" data-number="B.2">
<h2 data-number="B.2" class="anchored" data-anchor-id="structural-stability"><span class="header-section-number">B.2</span> Structural stability</h2>
<p>Consider the one-parameter ODE <span class="math display">\[
\mathbf{y}' = \mathbf{f}(\mathbf{y},p),
\]</span></p>
<p>and suppose that the problem is well-posed for <span class="math inline">\(p\in\mathcal{P}\subseteq\mathbb{R}\)</span> and <span class="math inline">\(\mathbf{f}\)</span>.</p>
<p>Given <span class="math inline">\(p=\bar{p}\)</span>, the system will have some phase portrait. Is it stable to small perturbations of the parameter <span class="math inline">\(p\)</span>? In other words, if we consider a new system: <span class="math display">\[
\tilde{\mathbf{y}}' = \mathbf{f}(\tilde{\mathbf{y}},p),
\]</span></p>
<p>with <span class="math inline">\(p \in (\bar{p}-\varepsilon, \bar{p}+\varepsilon)\)</span>, <span class="math inline">\(\varepsilon\ll 1\)</span>, is the “error” between <span class="math inline">\(\tilde{\mathbf{y}}(t)\)</span> and <span class="math inline">\(\mathbf{y}(t)\)</span> going to zero as <span class="math inline">\(\varepsilon\to 0\)</span> for any choice of the initial condition? That is, is the phase portrait of the perturbed system “converging” to the phase portrait of the original ODE? This is typically the case.</p>
<div id="thm-structstab" class="theorem">
<p><span class="theorem-title"><strong>Theorem B.1 (stability to perturbations)</strong></span> Suppose that <span class="math inline">\(\mathbf{f}(\mathbf{y},p)\)</span> is continuous and locally Lipschitz in <span class="math inline">\(\mathbf{y}\)</span>, uniformly in <span class="math inline">\(p\)</span>, and that the ODE is well-posed for any choice of <span class="math inline">\(p\)</span> in the interval. Then the solution of the ODE <span class="math inline">\(\boldsymbol{\phi}(t,\mathbf{y}_0,p)\to\boldsymbol{\phi}(t,\mathbf{y}_0,\bar{p})\)</span> uniformly as <span class="math inline">\(p\to \bar{p}\)</span>.</p>
</div>
<p>This theorem gives a zero-stability result, in the limit <span class="math inline">\(p\to \bar{p}\)</span>. How about the case of <span class="math inline">\(p\in(\bar{p}-\varepsilon, \bar{p}+\varepsilon)\)</span> but <span class="math inline">\(\varepsilon &gt; 0\)</span>? Is the perturbed ODE still “close” to the original one? We have the following definition</p>
<div id="def-structstab" class="theorem definition">
<p><span class="theorem-title"><strong>Definition B.1 (structural stability)</strong></span> The original ODE is <em>structurally stable</em> in some (closed) region of the phase space if and only if there exists <span class="math inline">\(\varepsilon &gt; 0\)</span> such that the perturbed system is <em>topologically equivalent</em> to the original ODE for all <span class="math inline">\(p\in (\bar{p}-\varepsilon, \bar{p}+\varepsilon)\)</span>.</p>
</div>
<div id="def-line" class="theorem definition">
<p><span class="theorem-title"><strong>Definition B.2 (topological equivalence)</strong></span> Two ODEs are <em>topologically equivalent</em> if there exists a diffeomorphism that smoothly maps the phase portrait of one system into the other, preserving the direction of time.</p>
</div>
<p>For instance, the two phase portraits below are topologically equivalent, because we can smoothly deform one into the other. (Put a fork at the center, then twist like you would do with spaghetti.)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/topological_equiv.png" class="img-fluid figure-img"></p>
<figcaption>Topological equivalence</figcaption>
</figure>
</div>
</section>
<section id="bifurcations" class="level2" data-number="B.3">
<h2 data-number="B.3" class="anchored" data-anchor-id="bifurcations"><span class="header-section-number">B.3</span> Bifurcations</h2>
<p>On the other hand, these below are <em>not</em> topologically equivalent, because if we shrink the limit cycle down to a point, we collide with another equilibrium at the center, making the map non-invertible.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/nontopo.png" class="img-fluid figure-img"></p>
<figcaption>Phase portraits that are not topologically equivalent</figcaption>
</figure>
</div>
<p>When we are a situation like the one above, we have a <em>bifurcation</em>.</p>
<div id="def-line" class="theorem definition">
<p><span class="theorem-title"><strong>Definition B.3 (bifurcation)</strong></span> If for some value <span class="math inline">\(p=\bar{p}\)</span> a system is <em>not</em> structurally stable, then for <span class="math inline">\(p=\bar{p}\)</span> we have a <em>bifurcation</em>.</p>
</div>
<p>Bifurcations result from the <em>collision</em> of invariant sets of the dynamical system, for instance 2 equilibria or 2 limit cycles colliding one into the other, for some value of the parameter. We can visualize this in a <em>bifurcation plot</em>, like the one below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/bifu1.png" class="img-fluid figure-img"></p>
<figcaption>bifurcation in 1D</figcaption>
</figure>
</div>
<p>where we have on the abscissa the parameter, and on the ordinate the phase space. The curves are equilibria, and for <span class="math inline">\(\bar{p}\)</span> we have a bifurcation.</p>
<p>The bifurcation plot is just a “stack” of phase portraits for various values of <span class="math inline">\(p\)</span>. In some sense, a smooth transition between one layer to the other implies topological equivalence, otherwise we have bifurcations. For instance, for planar system we could have:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/bifu2.png" class="img-fluid figure-img"></p>
<figcaption>bifurcation in 2D</figcaption>
</figure>
</div>
<p>The “cone” is formed by limit cycles. Here, we have 3 bifurcations.</p>
</section>
<section id="continuation-of-equilibria" class="level2" data-number="B.4">
<h2 data-number="B.4" class="anchored" data-anchor-id="continuation-of-equilibria"><span class="header-section-number">B.4</span> Continuation of equilibria</h2>
<p>Consider the dynamical system in 1D: <span class="math display">\[
y' = f(y,p),
\]</span></p>
<p>with <span class="math inline">\(p\in\mathbb{R}\)</span>. An equilibrium <span class="math inline">\(\bar{y}\)</span> of the ODE for a given parameter <span class="math inline">\(\bar{p}\)</span> is a solution to the equation: <span class="math display">\[
0 = f(\bar{y},\bar{p}).
\]</span></p>
<p>Suppose that <span class="math inline">\(f\)</span> is a smooth function in <span class="math inline">\((y,p)\)</span>. Thanks to the implicit function theorem, if <span class="math inline">\(\partial_p f(\bar{y}, \bar{p})\neq 0\)</span> we can locally define a represent the curve <span class="math inline">\(f(\bar{y}, \bar{p})=0\)</span> in the space <span class="math inline">\((y,p)\in\mathbb{R}^2\)</span> with a function <span class="math inline">\(y=\phi(p)\)</span> such that <span class="math inline">\(f(\phi(p),p)=0\)</span> for <span class="math inline">\(p\in \mathcal{B}_\varepsilon(\bar{p})\)</span>, some neighborhood of <span class="math inline">\(\bar{p}\)</span>.</p>
<p>The curve <span class="math inline">\((\phi(p),p)\)</span> represents the <em>continuation</em> of the equilibrium <span class="math inline">\(\bar{y}\)</span> as we change the parameter <span class="math inline">\(p=\bar{p}\)</span>. All points along <span class="math inline">\((\phi(p),p)\)</span> are equilibria, by construction, for different values of the parameter <span class="math inline">\(p\)</span>.</p>
<p>We can extend the same construction in several dimensions, say <span class="math inline">\(\mathbf{y}\in\mathbb{R}^n\)</span> and <span class="math inline">\(p\in\mathbb{R}\)</span>. Let us by <span class="math inline">\(\mathbf{f}_\mathbf{y}(\mathbf{y},p)\)</span> the Jacobian of <span class="math inline">\(\mathbf{f}\)</span> with respect to <span class="math inline">\(\mathbf{y}\)</span>. Suppose that <span class="math inline">\(\bar{\mathbf{y}}\)</span> is an equilibrium for the ODE <span class="math display">\[
\mathbf{y}' = \mathbf{f}(\mathbf{y},\bar{p}),
\]</span></p>
<p>that is, <span class="math inline">\(\mathbf{f}(\bar{\mathbf{y}},\bar{p})=\mathbf{0}\)</span>, and that <span class="math display">\[
\det \mathbf{f}_\mathbf{y}(\bar{\mathbf{y}},\bar{p}) \neq 0,
\]</span></p>
<p>then there exists a function <span class="math inline">\(\mathbf{y}=\boldsymbol{\phi}(p)\)</span> such that <span class="math inline">\(\mathbf{f}(\boldsymbol{\phi}(p),p)=\mathbf{0}\)</span> for <span class="math inline">\(p\in\mathcal{B}_\varepsilon(\bar{p})\)</span>.</p>
<p>The <em>stability</em> of the equilibria along the curve is also preserved: the eigenvalues of <span class="math inline">\(\mathbf{f}_\mathbf{y}(\mathbf{y},p)\)</span> depends continuously on <span class="math inline">\(p\)</span> so the branch of equilibria <span class="math inline">\(\mathbf{y}=\boldsymbol{\phi}(p)\)</span> will inherit the same stability properties of <span class="math inline">\(\bar{\mathbf{y}}\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/continuation.png" class="img-fluid figure-img"></p>
<figcaption>Curve of equilibria</figcaption>
</figure>
</div>
<p><em>What if an eigenvalue of <span class="math inline">\(\mathbf{f}_\mathbf{y}(\boldsymbol{\phi}(p),p)\)</span> will end up with zero real part along the curve?</em></p>
<p>Then we have a bifurcation. We still denote this point with <span class="math inline">\(\bar{p}\)</span> and the corresponding equilibrium with <span class="math inline">\(\bar{\mathbf{y}}\)</span>. We have different options:</p>
<ul>
<li><p><strong>Tangent bifurcation.</strong> <span class="math inline">\(\mathbf{f}_\mathbf{y}(\bar{\mathbf{y}},\bar{p})\)</span> as eigenvalue 0 and <span class="math inline">\(\mathbf{f}_p(\bar{\mathbf{y}},\bar{p}) \neq 0\)</span>.</p></li>
<li><p><strong>Transcritical bifurcation.</strong> <span class="math inline">\(\mathbf{f}_\mathbf{y}(\bar{\mathbf{y}},\bar{p})\)</span> as eigenvalue 0 and <span class="math inline">\(\mathbf{f}_p(\bar{\mathbf{y}},\bar{p}) = 0\)</span>.</p></li>
<li><p><strong>Hopf bifurcation.</strong> <span class="math inline">\(\mathbf{f}_\mathbf{y}(\bar{\mathbf{y}},\bar{p})\)</span> as eigenvalue <span class="math inline">\(\pm i\omega\)</span> (only <span class="math inline">\(n\ge 2\)</span>).</p></li>
</ul>
<p>Note that if one real eigenvalue is zero, then we cannot apply the implicit function theorem, and the curve <span class="math inline">\(\boldsymbol{\phi}\)</span> cannot be defined at <span class="math inline">\(p=\bar{p}\)</span> (this is the case of the first 2 bifurcations.)</p>
</section>
<section id="sec-tangbif" class="level2" data-number="B.5">
<h2 data-number="B.5" class="anchored" data-anchor-id="sec-tangbif"><span class="header-section-number">B.5</span> Tangent bifurcation</h2>
<p>The simplest bifurcation is perhaps the tangent bifurcation. Consider the following ODE: <span class="math display">\[
y' = f(y,p) = p - y^2,
\]</span></p>
<p>for <span class="math inline">\(p\in\mathbb{R}\)</span>. We have the following situation:</p>
<ul>
<li>If <span class="math inline">\(p&gt;0\)</span> there are 2 equilibria, <span class="math inline">\(\bar{y}^{\pm} = \pm\sqrt{p}\)</span>. Since <span class="math inline">\(\partial_y f = -2y\)</span>, we have that <span class="math inline">\(\bar{y}^-\)</span> is unstable and <span class="math inline">\(\bar{y}^+\)</span> is asympotically stable.</li>
<li>If <span class="math inline">\(p&lt;0\)</span> there is no real equilibrium.</li>
<li>If <span class="math inline">\(p=\bar{p}=0\)</span> we have a single equilibrium <span class="math inline">\(\bar{y}=0\)</span>. The stability cannot be deduced from the linearization (why?), but from the sign of <span class="math inline">\(f\)</span> we see that <span class="math inline">\(\bar{y}\)</span> is attractive for <span class="math inline">\(y&gt;0\)</span> and repulsive for <span class="math inline">\(y&lt;0\)</span>. It is called <em>saddle-node</em>.</li>
</ul>
<p>Since <span class="math inline">\(\partial_y f(\bar{y},\bar{p})=0\)</span> but <span class="math inline">\(\partial_p f(\bar{y},\bar{p}) = 1 \neq 0\)</span>, for <span class="math inline">\(p=\bar{p}=0\)</span> we have a <em>tangent bifurcation</em>. Tangent bifurcations are also called <em>limit points</em> (in MatCont denoted by <code>LP</code>). The reason for the name should be clear from the bifurcation plot.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/TangentBif.jpg" class="img-fluid figure-img"></p>
<figcaption>tangent bifurcation</figcaption>
</figure>
</div>
<p>Tangent bifurcations are <em>catastrophic</em>, in the sense that a point at equilibrium right before the bifurcation will diverge from its state after the bifurcation (imagine to move a point along the stable branch from right to left.) Note that the curve is smooth, because <span class="math inline">\(\partial_p f(\bar{y},\bar{p})\neq 0\)</span>. Check the next figure, where we visualize <span class="math inline">\(f(y,p)\)</span> around the bifurcation (in black the zero levelset, that is the curve of equilibria):</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/bif_tangent_3d.png" class="img-fluid figure-img"></p>
<figcaption>image</figcaption>
</figure>
</div>
</section>
<section id="sec-transbif" class="level2" data-number="B.6">
<h2 data-number="B.6" class="anchored" data-anchor-id="sec-transbif"><span class="header-section-number">B.6</span> Transcritical bifurcation</h2>
<p>The transcritical bifurcation occurs when an equilibrium has 0 real part and also <span class="math inline">\(\partial_p f(\bar{y},\bar{p})=0\)</span>. The normal form is: <span class="math display">\[
y' = py - y^2.
\]</span></p>
<p>The derivative of <span class="math inline">\(f\)</span> is <span class="math inline">\(f_y(y,p) = p-2y\)</span>. We have 2 equilibria,</p>
<ul>
<li><span class="math inline">\(y_0=0\)</span>, stable for <span class="math inline">\(p&gt;0\)</span> and unstable for <span class="math inline">\(p&lt;0\)</span>.</li>
<li><span class="math inline">\(\bar{y}=p\)</span>, unstable for <span class="math inline">\(p&gt;0\)</span> and stable for <span class="math inline">\(p&lt;0\)</span>.</li>
</ul>
<p>For <span class="math inline">\(p=0\)</span> we only have one equilibrium <span class="math inline">\(\bar{y}=0\)</span>, which is a saddle-node because it is attractive for <span class="math inline">\(y&lt;0\)</span> and repulsive for <span class="math inline">\(y&gt;0\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/Transcritical.jpeg" class="img-fluid figure-img"></p>
<figcaption>image</figcaption>
</figure>
</div>
<p>Transcritical bifurcations are very common in biological modeling, because some equilibria (like the origin) do not depend on the parameters and are always present. Therefore, in the bifurcation plot their curve do not change, and can be intersected by other curves of equilibria. In fact, if <span class="math inline">\(f(0,p)=0\)</span> for all <span class="math inline">\(p\)</span>, then also <span class="math inline">\(f_p(0,p)=0\)</span>. Note that the above model is the logistic equation.</p>
<p>From the 3d visualization of <span class="math inline">\(f\)</span>:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/bif_trans.png" class="img-fluid figure-img"></p>
<figcaption>image</figcaption>
</figure>
</div>
<p>we see a critical point at the bifurcation point. The eigenvectors give the tangents to the 2 curves of equilibria. In this way, it is possible to switch curve at the bifurcation point.</p>
</section>
<section id="hopf-bifurcation" class="level2" data-number="B.7">
<h2 data-number="B.7" class="anchored" data-anchor-id="hopf-bifurcation"><span class="header-section-number">B.7</span> Hopf bifurcation</h2>
<p>The Hopf bifurcation occurs when an equilibrium changes stability and a limit cycle appears. The normal form is: <span class="math display">\[
\left\{ \begin{aligned}
x' &amp;= \sigma x + \omega y + c x (x^2 + y^2), \\
y' &amp;= \sigma y - \omega x + c y (x^2 + y^2), \\
\end{aligned} \right.
\]</span></p>
<p>Suppose that <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(\mu\)</span>, and <span class="math inline">\(c\)</span> depend on some parameter <span class="math inline">\(p\in\mathbb{R}\)</span>.</p>
<p>We have that <span class="math inline">\((x,y)=(0,0)\)</span> is an equilibrium for all choices of <span class="math inline">\(p\)</span>. The Jacobian at <span class="math inline">\((0,0)\)</span> has eigenvalues <span class="math display">\[
\lambda^\pm = \sigma \pm i \omega,
\]</span></p>
<p>When <span class="math inline">\(\sigma(p) = 0\)</span>, the real part of the complex conjugate eigenvalues becomes zero: we have a Hopf bifurcation. To check the existence of a limit cycle, we consider the system in polar coordinates: <span class="math display">\[
\left\{ \begin{aligned}
x &amp;= r \cos\theta, \\
y &amp;= r \sin\theta,
\end{aligned} \right.
\quad\Rightarrow\quad
\left\{ \begin{aligned}
r &amp;= \sqrt{x^2 + y^2}, \\
\theta &amp;= \arctan (y/x).
\end{aligned} \right.
\]</span></p>
<p>To change the variables, simply note that: <span class="math display">\[
\begin{split}
r\mathrm{d}r &amp;= \tfrac{1}{2}\mathrm{d}(r^2) = x\mathrm{d}x + y\mathrm{d}y \\
&amp;= \bigl(\sigma (x^2 + y^2) + c (x^2 + y^2)(x^2 + y^2) \bigr)\mathrm{d}t = \\
&amp;= \bigl(\sigma r^2 + c r^4 \bigr)\mathrm{d}t,
\end{split}
\]</span></p>
<p>and <span class="math display">\[
\begin{split}
\mathrm{d}\theta &amp;= \frac{\mathrm{d}y/x - y\mathrm{d}x/x^2}{1 + (y/x)^2} = \frac{x\mathrm{d}y - y\mathrm{d}x}{x^2 + y^2} \\
&amp;= \frac{x(\sigma y - \omega x + cy(x^2+y^2)) - y(\sigma x + \omega y + cx(x^2+y^2))}{x^2 + y^2}\mathrm{d}t \\
&amp;= -\frac{\omega (x^2 + y^2)}{x^2 + y^2}\mathrm{d}t = -\omega\mathrm{d}t.
\end{split}
\]</span></p>
<p>The system in polar coordinates is: <span class="math display">\[
\left\{ \begin{aligned}
r' &amp;= \sigma r + c r^3, \\
\theta' &amp;= -\omega. \\
\end{aligned} \right.
\]</span></p>
<p>Assuming <span class="math inline">\(\omega(p)\neq 0\)</span>, we have two equilibria:</p>
<ul>
<li><p><span class="math inline">\(r=0\)</span>, which corresponds to the origin and we know it is stable for <span class="math inline">\(\sigma(p)&lt;0\)</span> and unstable for <span class="math inline">\(\sigma(p)&gt;0\)</span>.</p></li>
<li><p><span class="math inline">\(r=\bar{r}=\sqrt{-\sigma/c}\)</span>, which exists only for <span class="math inline">\(c(p)\neq 0\)</span> and <span class="math inline">\(\sigma(p)c(p)&lt;0\)</span>. When there exists, it is stable if <span class="math inline">\(\sigma(p)&gt;0\)</span> and unstable if <span class="math inline">\(\sigma(p)&lt;0\)</span>. This corresponds to a limit cycle of radius <span class="math inline">\(\bar{r}\)</span>.</p></li>
</ul>
<p>In conclusion, we have 2 types of Hopf bifurcations.</p>
<ul>
<li><em>Supercritical Hopf bifurcation</em> <span class="math inline">\(H^S\)</span>: <span class="math inline">\(\sigma'(\bar{p})&gt;0\)</span> and <span class="math inline">\(c(\bar{p})&lt;0\)</span>. The stable equilibrium at the origin becomes unstable and a stable limit cycle is born. The bifurcation is not catastrophical.</li>
</ul>
<p><img src="img/HSuper.jpeg" class="img-fluid"></p>
<ul>
<li><em>Subrcritical Hopf bifurcation</em> <span class="math inline">\(H_S\)</span>: <span class="math inline">\(\sigma'(\bar{p})&lt;0\)</span> and <span class="math inline">\(c(\bar{p})&gt;0\)</span>. The unstable equilibrium at the origin becomes stable and an unstable limit cycle is born. The bifurcation is catastrophical.</li>
</ul>
<p><img src="img/HSub.jpeg" class="img-fluid"></p>
<p>Note that for <span class="math inline">\(c=0\)</span> at the bifurcation point we have an infinite number of limit cycles (non-isolated periodic orbit), like the classical oscillator. This is a <em>degenerate Hopf bifurcation</em> so the condition <span class="math inline">\(c(\bar{p})\neq 0\)</span> is called <em>non-degeneracy condition</em>. The condition <span class="math inline">\(\sigma'(\bar{p})\neq 0\)</span> is called <em>trasversality condition</em>.</p>
<p>For a general system of ODEs: <span class="math display">\[
\left\{ \begin{aligned}
x' &amp;= f(x,y,p), \\
y' &amp;= g(x,y,p), \\
\end{aligned} \right.
\]</span></p>
<p>such that <span class="math inline">\((\bar{x},\bar{y})=(0,0)\)</span> is an equilibrium (with no loss of generality we can take the equilibrium at the origin), thanks to linearization we can always write the system around the equilibrium in the form: <span class="math display">\[
\left\{ \begin{aligned}
x' &amp;= \sigma(p) x + \omega(p) y + \tilde{f}(x,y,p), \\
y' &amp;= \sigma(p) y - \omega(p) x + \tilde{g}(x,y,p), \\
\end{aligned} \right.
\]</span></p>
<p>with <span class="math inline">\(\tilde{f}(0,0,p)=\tilde{g}(0,0,p)=0\)</span>. It is possible to further expand <span class="math inline">\(\tilde{f}\)</span> and <span class="math inline">\(\tilde{g}\)</span> so to find a term of the form <span class="math inline">\(cr^3\)</span> as above. The coefficient <span class="math inline">\(c\)</span> is called <em>first Lyapunov exponent</em> and it reads: <span class="math display">\[
\begin{split}
16 c &amp;= f_{xxx} + f_{xyy} + g_{xxy} + g_{yyy} \\
&amp;+ \frac{1}{\omega} \Bigl( f_{xy}(f_{xx}+f_{yy}) - g_{xy}(g_{xx}+g_{yy}) - f_{xx}g_{xx} - f_{yy}g_{yy} \Bigr).
\end{split}
\]</span></p>
<p>Then we have the following:</p>
<div id="thm-hopf" class="theorem">
<p><span class="theorem-title"><strong>Theorem B.2 (Hopf)</strong></span> Suppose that <span class="math inline">\(\sigma'(p)\neq 0\)</span> (trasversality) and <span class="math inline">\(c\neq 0\)</span> (non-degeneracy). Then there exists a branch <span class="math inline">\(\Gamma_p\)</span> of periodic solutions with period <span class="math inline">\(T(p)\)</span> for <span class="math inline">\(p\)</span> such that <span class="math inline">\(|p-\bar{p}|\)</span> is small and <span class="math inline">\(p &gt; \bar{p}\)</span> if <span class="math inline">\(\sigma'(\bar{p})c &lt; 0\)</span> (resp. <span class="math inline">\(p &lt; \bar{p}\)</span> if <span class="math inline">\(\sigma'(\bar{p})c &gt; 0\)</span>). Furthermore, <span class="math inline">\(\Gamma_p \to \bar{y}\)</span> for <span class="math inline">\(p\to\bar{p}\)</span> and <span class="math inline">\(T(p)\to \frac{2\pi}{\omega(\bar{p})}\)</span>. If <span class="math inline">\(c&lt;0\)</span> <span class="math inline">\(\Gamma_p\)</span> are attracting; if <span class="math inline">\(c&gt;0\)</span> <span class="math inline">\(\Gamma_p\)</span> are repelling.</p>
</div>
<p>We observed the Hopf bifurcation in Gause-type prey-predator models and in negative feedback networks.</p>
</section>
<section id="limit-cycle-tangent-bifurcation" class="level2" data-number="B.8">
<h2 data-number="B.8" class="anchored" data-anchor-id="limit-cycle-tangent-bifurcation"><span class="header-section-number">B.8</span> Limit cycle tangent bifurcation</h2>
<p>Consider the following model: <span class="math display">\[
\left\{ \begin{aligned}
r' &amp;= r\sigma\bigl(1 + c r^2 - r^4 \bigr), \\
\theta' &amp;= -\omega. \\
\end{aligned} \right.
\]</span></p>
<p>We have 3 equilibria (note that necessarily <span class="math inline">\(r\ge0\)</span>): the origin <span class="math inline">\(r=0\)</span> and: <span class="math display">\[
\bar{r} = \sqrt{\frac{c \pm \sqrt{c^2+4\sigma}}{2}}.
\]</span></p>
<p>If we study the existence of limit cycles (LCs) in the <span class="math inline">\((\sigma,c)\)</span> plane we have:</p>
<p><img src="img/LCtangent.jpeg" class="img-fluid"></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(H^S\)</span>: supercritical Hopf bifurcation,</li>
<li><span class="math inline">\(H_S\)</span>: subcritical Hopf bifurcation,</li>
<li><span class="math inline">\(T\)</span>: tangent bifurcation between limit cycles.</li>
</ul>
<p>In terms of stability we have:</p>
<p><img src="img/LCtangent2.jpeg" class="img-fluid"></p>
<p>As we cross <span class="math inline">\(T\)</span> we have 2 limit cycles colliding and disappearing, exactly like the tangent bifurcation between equilibria. (In fact, this is what happens in polar coordinates.)</p>
<p>The tangent bifurcation can be visualized as follows:</p>
<p><img src="img/LCtang3D.png" class="img-fluid"></p>
<p>We have seen this type of bifurcation in a negative feedback loop. It is catastrophic.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./IntroODE.html" class="pagination-link" aria-label="Introduction to ODEs">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Introduction to ODEs</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Laboratories/00_Intro_Matlab/introMATLAB.html" class="pagination-link" aria-label="Introduction to MATLAB">
        <span class="nav-page-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Introduction to MATLAB</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>